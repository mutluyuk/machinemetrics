<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 23 Forecast | MachineMetrics</title>
  <meta name="description" content="Chapter 23 Forecast | MachineMetrics" />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 23 Forecast | MachineMetrics" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/png/MachineMetrics.png" />
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 23 Forecast | MachineMetrics" />
  
  
  <meta name="twitter:image" content="/png/MachineMetrics.png" />

<meta name="author" content="Yigit Aydede and Mutlu Yuksel" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="time-series.html"/>
<link rel="next" href="support-vector-machine.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">.</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#why-this-book-is-different"><i class="fa fa-check"></i>Why this book is different?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#structure-of-manuscript"><i class="fa fa-check"></i>Structure of Manuscript:</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#who-can-use-this-book"><i class="fa fa-check"></i>Who Can Use This Book?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i>License</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction:</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#prediction-vs.-estimation"><i class="fa fa-check"></i><b>1.1</b> Prediction vs. Estimation:</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#where-can-you-use-the-covered-topics-in-social-sciences"><i class="fa fa-check"></i><b>1.2</b> Where can you use the covered topics in Social Sciences?:</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#translation-of-concepts-different-terminology"><i class="fa fa-check"></i><b>1.3</b> Translation of Concepts: Different Terminology</a></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#is-machine-learning-better"><i class="fa fa-check"></i><b>1.4</b> Is Machine Learning Better?</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="statistical-models-and-simulations.html"><a href="statistical-models-and-simulations.html"><i class="fa fa-check"></i><b>2</b> Statistical Models and Simulations</a>
<ul>
<li class="chapter" data-level="2.1" data-path="statistical-models-and-simulations.html"><a href="statistical-models-and-simulations.html#distinguishing-between-statistical-modeling-and-machine-learning-in-data-analysis"><i class="fa fa-check"></i><b>2.1</b> Distinguishing Between Statistical Modeling and Machine Learning in Data Analysis</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="statistical-models-and-simulations.html"><a href="statistical-models-and-simulations.html#goals-and-objectives"><i class="fa fa-check"></i><b>2.1.1</b> Goals and Objectives</a></li>
<li class="chapter" data-level="2.1.2" data-path="statistical-models-and-simulations.html"><a href="statistical-models-and-simulations.html#prediction-vs.-inference"><i class="fa fa-check"></i><b>2.1.2</b> Prediction vs. Inference</a></li>
<li class="chapter" data-level="2.1.3" data-path="statistical-models-and-simulations.html"><a href="statistical-models-and-simulations.html#conclusion"><i class="fa fa-check"></i><b>2.1.3</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="statistical-models-and-simulations.html"><a href="statistical-models-and-simulations.html#parametric-and-nonparametric-models"><i class="fa fa-check"></i><b>2.2</b> Parametric and Nonparametric Models:</a></li>
<li class="chapter" data-level="2.3" data-path="statistical-models-and-simulations.html"><a href="statistical-models-and-simulations.html#predictive-vs.-causal-models"><i class="fa fa-check"></i><b>2.3</b> Predictive vs. Causal Models</a></li>
<li class="chapter" data-level="2.4" data-path="statistical-models-and-simulations.html"><a href="statistical-models-and-simulations.html#model-selection-and-approaches-in-data-modeling"><i class="fa fa-check"></i><b>2.4</b> Model Selection and Approaches in Data Modeling</a></li>
<li class="chapter" data-level="2.5" data-path="statistical-models-and-simulations.html"><a href="statistical-models-and-simulations.html#simulation"><i class="fa fa-check"></i><b>2.5</b> Simulation</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="counterfactual.html"><a href="counterfactual.html"><i class="fa fa-check"></i><b>3</b> Counterfactual:</a>
<ul>
<li class="chapter" data-level="3.1" data-path="counterfactual.html"><a href="counterfactual.html#qualitative-and-quantitative-research-methods"><i class="fa fa-check"></i><b>3.1</b> Qualitative and Quantitative research methods:</a></li>
<li class="chapter" data-level="3.2" data-path="counterfactual.html"><a href="counterfactual.html#quantitative---research-methods"><i class="fa fa-check"></i><b>3.2</b> Quantitative - Research methods :</a></li>
<li class="chapter" data-level="3.3" data-path="counterfactual.html"><a href="counterfactual.html#data-and-visualization"><i class="fa fa-check"></i><b>3.3</b> Data and visualization</a></li>
<li class="chapter" data-level="3.4" data-path="counterfactual.html"><a href="counterfactual.html#correlation"><i class="fa fa-check"></i><b>3.4</b> Correlation</a></li>
<li class="chapter" data-level="3.5" data-path="counterfactual.html"><a href="counterfactual.html#effect-of-x-on-y-regression"><i class="fa fa-check"></i><b>3.5</b> Effect of X on Y / Regression</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="counterfactual.html"><a href="counterfactual.html#how-can-we-estimate-the-population-parameters-beta_0-and-beta_1"><i class="fa fa-check"></i><b>3.5.1</b> How can we estimate the population parameters, <span class="math inline">\(\beta_{0}\)</span> and <span class="math inline">\(\beta_{1}\)</span>?</a></li>
<li class="chapter" data-level="3.5.2" data-path="counterfactual.html"><a href="counterfactual.html#predicting-y"><i class="fa fa-check"></i><b>3.5.2</b> Predicting <span class="math inline">\(y\)</span></a></li>
<li class="chapter" data-level="3.5.3" data-path="counterfactual.html"><a href="counterfactual.html#mle"><i class="fa fa-check"></i><b>3.5.3</b> MLE</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="counterfactual.html"><a href="counterfactual.html#causal-effect"><i class="fa fa-check"></i><b>3.6</b> Causal Effect</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="counterfactual.html"><a href="counterfactual.html#average-treatment-effectate"><i class="fa fa-check"></i><b>3.6.1</b> Average Treatment Effect(ATE)</a></li>
<li class="chapter" data-level="3.6.2" data-path="counterfactual.html"><a href="counterfactual.html#additional-treatment-effects"><i class="fa fa-check"></i><b>3.6.2</b> Additional Treatment Effects</a></li>
<li class="chapter" data-level="3.6.3" data-path="counterfactual.html"><a href="counterfactual.html#selection-bias-and-heteregeneous-treatment-effect-bias"><i class="fa fa-check"></i><b>3.6.3</b> Selection Bias and Heteregeneous Treatment Effect Bias:</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="learning.html"><a href="learning.html"><i class="fa fa-check"></i><b>4</b> Learning</a>
<ul>
<li class="chapter" data-level="" data-path="learning.html"><a href="learning.html#learning-systems"><i class="fa fa-check"></i>Learning Systems</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="error.html"><a href="error.html"><i class="fa fa-check"></i><b>5</b> Error</a>
<ul>
<li class="chapter" data-level="5.1" data-path="error.html"><a href="error.html#estimation-error---mse"><i class="fa fa-check"></i><b>5.1</b> Estimation error - MSE</a></li>
<li class="chapter" data-level="5.2" data-path="error.html"><a href="error.html#prediction-error--mspe"><i class="fa fa-check"></i><b>5.2</b> Prediction error- MSPE</a></li>
<li class="chapter" data-level="5.3" data-path="error.html"><a href="error.html#technical-points-about-mse-and-mspe"><i class="fa fa-check"></i><b>5.3</b> Technical points about MSE and MSPE</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="bias-variance-trade-off.html"><a href="bias-variance-trade-off.html"><i class="fa fa-check"></i><b>6</b> Bias-Variance Trade-off</a>
<ul>
<li class="chapter" data-level="6.1" data-path="bias-variance-trade-off.html"><a href="bias-variance-trade-off.html#biased-estimator-as-a-predictor"><i class="fa fa-check"></i><b>6.1</b> Biased estimator as a predictor</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="overfitting.html"><a href="overfitting.html"><i class="fa fa-check"></i><b>7</b> Overfitting</a></li>
<li class="chapter" data-level="8" data-path="regression-v.s.-classification.html"><a href="regression-v.s.-classification.html"><i class="fa fa-check"></i><b>8</b> Regression v.s. Classification</a></li>
<li class="chapter" data-level="9" data-path="parametric-estimations---basics.html"><a href="parametric-estimations---basics.html"><i class="fa fa-check"></i><b>9</b> Parametric Estimations - Basics</a>
<ul>
<li class="chapter" data-level="9.1" data-path="parametric-estimations---basics.html"><a href="parametric-estimations---basics.html#parametric-estimations"><i class="fa fa-check"></i><b>9.1</b> Parametric Estimations</a></li>
<li class="chapter" data-level="9.2" data-path="parametric-estimations---basics.html"><a href="parametric-estimations---basics.html#lpm"><i class="fa fa-check"></i><b>9.2</b> LPM</a></li>
<li class="chapter" data-level="9.3" data-path="parametric-estimations---basics.html"><a href="parametric-estimations---basics.html#logistic-regression"><i class="fa fa-check"></i><b>9.3</b> Logistic Regression</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="nonparametric-estimations---basics.html"><a href="nonparametric-estimations---basics.html"><i class="fa fa-check"></i><b>10</b> Nonparametric Estimations - Basics</a>
<ul>
<li class="chapter" data-level="10.1" data-path="nonparametric-estimations---basics.html"><a href="nonparametric-estimations---basics.html#density-estimations"><i class="fa fa-check"></i><b>10.1</b> Density estimations</a></li>
<li class="chapter" data-level="10.2" data-path="nonparametric-estimations---basics.html"><a href="nonparametric-estimations---basics.html#kernel-regression"><i class="fa fa-check"></i><b>10.2</b> Kernel regression</a></li>
<li class="chapter" data-level="10.3" data-path="nonparametric-estimations---basics.html"><a href="nonparametric-estimations---basics.html#knn"><i class="fa fa-check"></i><b>10.3</b> Knn</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="nonparametric-estimations---basics.html"><a href="nonparametric-estimations---basics.html#adult-dataset"><i class="fa fa-check"></i><b>10.3.1</b> Adult dataset</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="hyperparameter-tuning.html"><a href="hyperparameter-tuning.html"><i class="fa fa-check"></i><b>11</b> Hyperparameter Tuning</a>
<ul>
<li class="chapter" data-level="11.1" data-path="hyperparameter-tuning.html"><a href="hyperparameter-tuning.html#training-and-validation"><i class="fa fa-check"></i><b>11.1</b> Training and Validation</a></li>
<li class="chapter" data-level="11.2" data-path="hyperparameter-tuning.html"><a href="hyperparameter-tuning.html#splitting-the-data-randomly"><i class="fa fa-check"></i><b>11.2</b> Splitting the data randomly</a></li>
<li class="chapter" data-level="11.3" data-path="hyperparameter-tuning.html"><a href="hyperparameter-tuning.html#k-fold-cross-validation"><i class="fa fa-check"></i><b>11.3</b> k-fold cross validation</a></li>
<li class="chapter" data-level="11.4" data-path="hyperparameter-tuning.html"><a href="hyperparameter-tuning.html#grid-search"><i class="fa fa-check"></i><b>11.4</b> Grid Search</a></li>
<li class="chapter" data-level="11.5" data-path="hyperparameter-tuning.html"><a href="hyperparameter-tuning.html#cross-validated-grid-search"><i class="fa fa-check"></i><b>11.5</b> Cross-validated grid search</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="optimization-algorithms---basics.html"><a href="optimization-algorithms---basics.html"><i class="fa fa-check"></i><b>12</b> Optimization Algorithms - Basics</a>
<ul>
<li class="chapter" data-level="12.1" data-path="optimization-algorithms---basics.html"><a href="optimization-algorithms---basics.html#brute-force-optimization"><i class="fa fa-check"></i><b>12.1</b> Brute-force optimization</a></li>
<li class="chapter" data-level="12.2" data-path="optimization-algorithms---basics.html"><a href="optimization-algorithms---basics.html#derivative-based-methods"><i class="fa fa-check"></i><b>12.2</b> Derivative-based methods</a></li>
<li class="chapter" data-level="12.3" data-path="optimization-algorithms---basics.html"><a href="optimization-algorithms---basics.html#ml-estimation-with-logistic-regression"><i class="fa fa-check"></i><b>12.3</b> ML Estimation with logistic regression</a></li>
<li class="chapter" data-level="12.4" data-path="optimization-algorithms---basics.html"><a href="optimization-algorithms---basics.html#gradient-descent-algorithm"><i class="fa fa-check"></i><b>12.4</b> Gradient Descent Algorithm</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="optimization-algorithms---basics.html"><a href="optimization-algorithms---basics.html#one-variable"><i class="fa fa-check"></i><b>12.4.1</b> One-variable</a></li>
<li class="chapter" data-level="12.4.2" data-path="optimization-algorithms---basics.html"><a href="optimization-algorithms---basics.html#adjustable-lr-and-sgd"><i class="fa fa-check"></i><b>12.4.2</b> Adjustable <code>lr</code> and SGD</a></li>
<li class="chapter" data-level="12.4.3" data-path="optimization-algorithms---basics.html"><a href="optimization-algorithms---basics.html#multivariable"><i class="fa fa-check"></i><b>12.4.3</b> Multivariable</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="optimization-algorithms---basics.html"><a href="optimization-algorithms---basics.html#optimization-with-r"><i class="fa fa-check"></i><b>12.5</b> Optimization with R</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="prediction-intervals.html"><a href="prediction-intervals.html"><i class="fa fa-check"></i><b>13</b> Prediction Intervals</a>
<ul>
<li class="chapter" data-level="13.1" data-path="prediction-intervals.html"><a href="prediction-intervals.html#prediction-interval-for-unbiased-ols-predictor"><i class="fa fa-check"></i><b>13.1</b> Prediction interval for unbiased OLS predictor</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="interpretability.html"><a href="interpretability.html"><i class="fa fa-check"></i><b>14</b> Interpretability</a>
<ul>
<li class="chapter" data-level="14.1" data-path="interpretability.html"><a href="interpretability.html#interpretable-vs-noninterpretable-models"><i class="fa fa-check"></i><b>14.1</b> Interpretable vs NonInterpretable Models</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="shrinkage-models.html"><a href="shrinkage-models.html"><i class="fa fa-check"></i><b>15</b> Shrinkage Models</a>
<ul>
<li class="chapter" data-level="15.1" data-path="shrinkage-models.html"><a href="shrinkage-models.html#ridge"><i class="fa fa-check"></i><b>15.1</b> Ridge</a></li>
<li class="chapter" data-level="15.2" data-path="shrinkage-models.html"><a href="shrinkage-models.html#lasso"><i class="fa fa-check"></i><b>15.2</b> Lasso</a></li>
<li class="chapter" data-level="15.3" data-path="shrinkage-models.html"><a href="shrinkage-models.html#adaptive-lasso"><i class="fa fa-check"></i><b>15.3</b> Adaptive Lasso</a></li>
<li class="chapter" data-level="15.4" data-path="shrinkage-models.html"><a href="shrinkage-models.html#sparsity"><i class="fa fa-check"></i><b>15.4</b> Sparsity</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="regression-trees.html"><a href="regression-trees.html"><i class="fa fa-check"></i><b>16</b> Regression Trees</a>
<ul>
<li class="chapter" data-level="16.1" data-path="regression-trees.html"><a href="regression-trees.html#cart---classification-tree"><i class="fa fa-check"></i><b>16.1</b> CART - Classification Tree</a></li>
<li class="chapter" data-level="16.2" data-path="regression-trees.html"><a href="regression-trees.html#rpart---recursive-partitioning"><i class="fa fa-check"></i><b>16.2</b> <code>rpart</code> - Recursive Partitioning</a></li>
<li class="chapter" data-level="16.3" data-path="regression-trees.html"><a href="regression-trees.html#pruning"><i class="fa fa-check"></i><b>16.3</b> Pruning</a></li>
<li class="chapter" data-level="16.4" data-path="regression-trees.html"><a href="regression-trees.html#classification-with-titanic"><i class="fa fa-check"></i><b>16.4</b> Classification with Titanic</a></li>
<li class="chapter" data-level="16.5" data-path="regression-trees.html"><a href="regression-trees.html#regression-tree"><i class="fa fa-check"></i><b>16.5</b> Regression Tree</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="ensemble-methods.html"><a href="ensemble-methods.html"><i class="fa fa-check"></i><b>17</b> Ensemble Methods</a>
<ul>
<li class="chapter" data-level="17.1" data-path="ensemble-methods.html"><a href="ensemble-methods.html#bagging"><i class="fa fa-check"></i><b>17.1</b> Bagging</a></li>
<li class="chapter" data-level="17.2" data-path="ensemble-methods.html"><a href="ensemble-methods.html#random-forest"><i class="fa fa-check"></i><b>17.2</b> Random Forest</a></li>
<li class="chapter" data-level="17.3" data-path="ensemble-methods.html"><a href="ensemble-methods.html#boosting"><i class="fa fa-check"></i><b>17.3</b> Boosting</a>
<ul>
<li class="chapter" data-level="17.3.1" data-path="ensemble-methods.html"><a href="ensemble-methods.html#sequential-ensemble-with-gbm"><i class="fa fa-check"></i><b>17.3.1</b> Sequential ensemble with <code>gbm</code></a></li>
<li class="chapter" data-level="17.3.2" data-path="ensemble-methods.html"><a href="ensemble-methods.html#adaboost"><i class="fa fa-check"></i><b>17.3.2</b> AdaBoost</a></li>
<li class="chapter" data-level="17.3.3" data-path="ensemble-methods.html"><a href="ensemble-methods.html#xgboost"><i class="fa fa-check"></i><b>17.3.3</b> XGBoost</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="ensemble-methods.html"><a href="ensemble-methods.html#ensemble-applications"><i class="fa fa-check"></i><b>17.4</b> Ensemble Applications</a></li>
<li class="chapter" data-level="17.5" data-path="ensemble-methods.html"><a href="ensemble-methods.html#classification"><i class="fa fa-check"></i><b>17.5</b> Classification</a></li>
<li class="chapter" data-level="17.6" data-path="ensemble-methods.html"><a href="ensemble-methods.html#regression"><i class="fa fa-check"></i><b>17.6</b> Regression</a></li>
<li class="chapter" data-level="17.7" data-path="ensemble-methods.html"><a href="ensemble-methods.html#exploration"><i class="fa fa-check"></i><b>17.7</b> Exploration</a></li>
<li class="chapter" data-level="17.8" data-path="ensemble-methods.html"><a href="ensemble-methods.html#boosting-applications"><i class="fa fa-check"></i><b>17.8</b> Boosting Applications</a>
<ul>
<li class="chapter" data-level="17.8.1" data-path="ensemble-methods.html"><a href="ensemble-methods.html#regression-1"><i class="fa fa-check"></i><b>17.8.1</b> Regression</a></li>
<li class="chapter" data-level="17.8.2" data-path="ensemble-methods.html"><a href="ensemble-methods.html#random-search-with-parallel-processing"><i class="fa fa-check"></i><b>17.8.2</b> Random search with parallel processing</a></li>
<li class="chapter" data-level="17.8.3" data-path="ensemble-methods.html"><a href="ensemble-methods.html#boosting-vs.-others"><i class="fa fa-check"></i><b>17.8.3</b> Boosting vs. Others</a></li>
<li class="chapter" data-level="17.8.4" data-path="ensemble-methods.html"><a href="ensemble-methods.html#classification-1"><i class="fa fa-check"></i><b>17.8.4</b> Classification</a></li>
<li class="chapter" data-level="17.8.5" data-path="ensemble-methods.html"><a href="ensemble-methods.html#adaboost.m1"><i class="fa fa-check"></i><b>17.8.5</b> AdaBoost.M1</a></li>
<li class="chapter" data-level="17.8.6" data-path="ensemble-methods.html"><a href="ensemble-methods.html#classification-with-xgboost"><i class="fa fa-check"></i><b>17.8.6</b> Classification with XGBoost</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="causal-effect-1.html"><a href="causal-effect-1.html"><i class="fa fa-check"></i><b>18</b> Causal Effect</a>
<ul>
<li class="chapter" data-level="18.1" data-path="causal-effect-1.html"><a href="causal-effect-1.html#random-experiment"><i class="fa fa-check"></i><b>18.1</b> Random experiment</a></li>
<li class="chapter" data-level="18.2" data-path="causal-effect-1.html"><a href="causal-effect-1.html#iv"><i class="fa fa-check"></i><b>18.2</b> IV</a></li>
<li class="chapter" data-level="18.3" data-path="causal-effect-1.html"><a href="causal-effect-1.html#diffd"><i class="fa fa-check"></i><b>18.3</b> DiffD</a></li>
<li class="chapter" data-level="18.4" data-path="causal-effect-1.html"><a href="causal-effect-1.html#rd"><i class="fa fa-check"></i><b>18.4</b> RD</a></li>
<li class="chapter" data-level="18.5" data-path="causal-effect-1.html"><a href="causal-effect-1.html#synthetic-control"><i class="fa fa-check"></i><b>18.5</b> Synthetic control</a></li>
<li class="chapter" data-level="18.6" data-path="causal-effect-1.html"><a href="causal-effect-1.html#doubledebiased-lassomethods"><i class="fa fa-check"></i><b>18.6</b> Double/Debiased Lasso/Methods</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="heterogeneous-treatment-effects.html"><a href="heterogeneous-treatment-effects.html"><i class="fa fa-check"></i><b>19</b> Heterogeneous Treatment Effects</a>
<ul>
<li class="chapter" data-level="19.1" data-path="heterogeneous-treatment-effects.html"><a href="heterogeneous-treatment-effects.html#causal-tree"><i class="fa fa-check"></i><b>19.1</b> Causal Tree</a></li>
<li class="chapter" data-level="19.2" data-path="heterogeneous-treatment-effects.html"><a href="heterogeneous-treatment-effects.html#causal-forest"><i class="fa fa-check"></i><b>19.2</b> Causal Forest</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="model-selection-and-sparsity.html"><a href="model-selection-and-sparsity.html"><i class="fa fa-check"></i><b>20</b> Model selection and Sparsity</a>
<ul>
<li class="chapter" data-level="20.1" data-path="model-selection-and-sparsity.html"><a href="model-selection-and-sparsity.html#model-selection"><i class="fa fa-check"></i><b>20.1</b> Model selection</a></li>
<li class="chapter" data-level="20.2" data-path="model-selection-and-sparsity.html"><a href="model-selection-and-sparsity.html#dropping-a-variable-in-a-regression"><i class="fa fa-check"></i><b>20.2</b> Dropping a variable in a regression</a></li>
<li class="chapter" data-level="20.3" data-path="model-selection-and-sparsity.html"><a href="model-selection-and-sparsity.html#out-sample-prediction-accuracy"><i class="fa fa-check"></i><b>20.3</b> out-sample prediction accuracy</a></li>
<li class="chapter" data-level="20.4" data-path="model-selection-and-sparsity.html"><a href="model-selection-and-sparsity.html#sparsity-1"><i class="fa fa-check"></i><b>20.4</b> Sparsity</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="classification-2.html"><a href="classification-2.html"><i class="fa fa-check"></i><b>21</b> Classification</a>
<ul>
<li class="chapter" data-level="21.1" data-path="classification-2.html"><a href="classification-2.html#nonparametric-classifier---knn"><i class="fa fa-check"></i><b>21.1</b> Nonparametric Classifier - kNN</a></li>
<li class="chapter" data-level="21.2" data-path="classification-2.html"><a href="classification-2.html#mnist-dataset"><i class="fa fa-check"></i><b>21.2</b> <code>mnist</code> Dataset</a></li>
<li class="chapter" data-level="21.3" data-path="classification-2.html"><a href="classification-2.html#linear-classifiers-again"><i class="fa fa-check"></i><b>21.3</b> Linear classifiers (again)</a></li>
<li class="chapter" data-level="21.4" data-path="classification-2.html"><a href="classification-2.html#k-nearest-neighbors"><i class="fa fa-check"></i><b>21.4</b> k-Nearest Neighbors</a></li>
<li class="chapter" data-level="21.5" data-path="classification-2.html"><a href="classification-2.html#knn-with-caret"><i class="fa fa-check"></i><b>21.5</b> kNN with caret</a>
<ul>
<li class="chapter" data-level="21.5.1" data-path="classification-2.html"><a href="classification-2.html#mnist_27"><i class="fa fa-check"></i><b>21.5.1</b> <code>mnist_27</code></a></li>
<li class="chapter" data-level="21.5.2" data-path="classification-2.html"><a href="classification-2.html#adult-dataset-1"><i class="fa fa-check"></i><b>21.5.2</b> Adult dataset</a></li>
</ul></li>
<li class="chapter" data-level="21.6" data-path="classification-2.html"><a href="classification-2.html#tuning-in-classification"><i class="fa fa-check"></i><b>21.6</b> Tuning in Classification</a></li>
<li class="chapter" data-level="21.7" data-path="classification-2.html"><a href="classification-2.html#confusion-matrix"><i class="fa fa-check"></i><b>21.7</b> Confusion matrix</a></li>
<li class="chapter" data-level="21.8" data-path="classification-2.html"><a href="classification-2.html#performance-measures"><i class="fa fa-check"></i><b>21.8</b> Performance measures</a></li>
<li class="chapter" data-level="21.9" data-path="classification-2.html"><a href="classification-2.html#roc-curve"><i class="fa fa-check"></i><b>21.9</b> ROC Curve</a></li>
<li class="chapter" data-level="21.10" data-path="classification-2.html"><a href="classification-2.html#auc---area-under-the-curve"><i class="fa fa-check"></i><b>21.10</b> AUC - Area Under the Curve</a></li>
<li class="chapter" data-level="21.11" data-path="classification-2.html"><a href="classification-2.html#classification-example"><i class="fa fa-check"></i><b>21.11</b> Classification Example</a></li>
<li class="chapter" data-level="21.12" data-path="classification-2.html"><a href="classification-2.html#lpm-1"><i class="fa fa-check"></i><b>21.12</b> LPM</a></li>
<li class="chapter" data-level="21.13" data-path="classification-2.html"><a href="classification-2.html#logistic-regression-1"><i class="fa fa-check"></i><b>21.13</b> Logistic Regression</a></li>
<li class="chapter" data-level="21.14" data-path="classification-2.html"><a href="classification-2.html#knn-1"><i class="fa fa-check"></i><b>21.14</b> kNN</a>
<ul>
<li class="chapter" data-level="21.14.1" data-path="classification-2.html"><a href="classification-2.html#knn-10-fold-cv"><i class="fa fa-check"></i><b>21.14.1</b> kNN 10-fold CV</a></li>
<li class="chapter" data-level="21.14.2" data-path="classification-2.html"><a href="classification-2.html#knn-with-caret-1"><i class="fa fa-check"></i><b>21.14.2</b> kNN with <code>caret</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="22" data-path="time-series.html"><a href="time-series.html"><i class="fa fa-check"></i><b>22</b> Time Series</a>
<ul>
<li class="chapter" data-level="22.1" data-path="time-series.html"><a href="time-series.html#arima-models"><i class="fa fa-check"></i><b>22.1</b> ARIMA models</a></li>
<li class="chapter" data-level="22.2" data-path="time-series.html"><a href="time-series.html#hyndman-khandakar-algorithm"><i class="fa fa-check"></i><b>22.2</b> Hyndman-Khandakar algorithm</a></li>
<li class="chapter" data-level="22.3" data-path="time-series.html"><a href="time-series.html#ts-plots"><i class="fa fa-check"></i><b>22.3</b> TS Plots</a></li>
<li class="chapter" data-level="22.4" data-path="time-series.html"><a href="time-series.html#box-cox-transformation"><i class="fa fa-check"></i><b>22.4</b> Box-Cox transformation</a></li>
<li class="chapter" data-level="22.5" data-path="time-series.html"><a href="time-series.html#stationarity"><i class="fa fa-check"></i><b>22.5</b> Stationarity</a></li>
<li class="chapter" data-level="22.6" data-path="time-series.html"><a href="time-series.html#modeling-arima"><i class="fa fa-check"></i><b>22.6</b> Modeling ARIMA</a></li>
<li class="chapter" data-level="22.7" data-path="time-series.html"><a href="time-series.html#grid-search-for-arima"><i class="fa fa-check"></i><b>22.7</b> Grid search for ARIMA</a></li>
<li class="chapter" data-level="22.8" data-path="time-series.html"><a href="time-series.html#hyperparameter-tuning-with-time-series-data"><i class="fa fa-check"></i><b>22.8</b> Hyperparameter tuning with time-series data:</a></li>
<li class="chapter" data-level="22.9" data-path="time-series.html"><a href="time-series.html#speed"><i class="fa fa-check"></i><b>22.9</b> Speed</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="forecast.html"><a href="forecast.html"><i class="fa fa-check"></i><b>23</b> Forecast</a>
<ul>
<li class="chapter" data-level="23.1" data-path="forecast.html"><a href="forecast.html#time-series-embedding"><i class="fa fa-check"></i><b>23.1</b> Time Series Embedding</a></li>
<li class="chapter" data-level="23.2" data-path="forecast.html"><a href="forecast.html#var-for-recursive-forecasting"><i class="fa fa-check"></i><b>23.2</b> VAR for Recursive Forecasting</a></li>
<li class="chapter" data-level="23.3" data-path="forecast.html"><a href="forecast.html#embedding-for-direct-forecast"><i class="fa fa-check"></i><b>23.3</b> Embedding for Direct Forecast</a></li>
<li class="chapter" data-level="23.4" data-path="forecast.html"><a href="forecast.html#random-forest-1"><i class="fa fa-check"></i><b>23.4</b> Random Forest</a></li>
<li class="chapter" data-level="23.5" data-path="forecast.html"><a href="forecast.html#univariate"><i class="fa fa-check"></i><b>23.5</b> Univariate</a></li>
<li class="chapter" data-level="23.6" data-path="forecast.html"><a href="forecast.html#multivariate"><i class="fa fa-check"></i><b>23.6</b> Multivariate</a></li>
<li class="chapter" data-level="23.7" data-path="forecast.html"><a href="forecast.html#rolling-and-expanding-windows"><i class="fa fa-check"></i><b>23.7</b> Rolling and expanding windows</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="support-vector-machine.html"><a href="support-vector-machine.html"><i class="fa fa-check"></i><b>24</b> Support Vector Machine</a>
<ul>
<li class="chapter" data-level="24.1" data-path="support-vector-machine.html"><a href="support-vector-machine.html#optimal-separating-classifier"><i class="fa fa-check"></i><b>24.1</b> Optimal Separating Classifier</a>
<ul>
<li class="chapter" data-level="24.1.1" data-path="support-vector-machine.html"><a href="support-vector-machine.html#the-margin"><i class="fa fa-check"></i><b>24.1.1</b> The Margin</a></li>
<li class="chapter" data-level="24.1.2" data-path="support-vector-machine.html"><a href="support-vector-machine.html#the-non-separable-case"><i class="fa fa-check"></i><b>24.1.2</b> The Non-Separable Case</a></li>
</ul></li>
<li class="chapter" data-level="24.2" data-path="support-vector-machine.html"><a href="support-vector-machine.html#nonlinear-boundary-with-kernels"><i class="fa fa-check"></i><b>24.2</b> Nonlinear Boundary with Kernels</a></li>
<li class="chapter" data-level="24.3" data-path="support-vector-machine.html"><a href="support-vector-machine.html#application-with-svm"><i class="fa fa-check"></i><b>24.3</b> Application with SVM</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="neural-networks.html"><a href="neural-networks.html"><i class="fa fa-check"></i><b>25</b> Neural Networks</a>
<ul>
<li class="chapter" data-level="25.1" data-path="neural-networks.html"><a href="neural-networks.html#neural-network---the-idea"><i class="fa fa-check"></i><b>25.1</b> Neural Network - the idea</a></li>
<li class="chapter" data-level="25.2" data-path="neural-networks.html"><a href="neural-networks.html#backpropagation"><i class="fa fa-check"></i><b>25.2</b> Backpropagation</a></li>
<li class="chapter" data-level="25.3" data-path="neural-networks.html"><a href="neural-networks.html#neural-network---more-inputs"><i class="fa fa-check"></i><b>25.3</b> Neural Network - More inputs</a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="deep-learning.html"><a href="deep-learning.html"><i class="fa fa-check"></i><b>26</b> Deep Learning</a></li>
<li class="chapter" data-level="27" data-path="graphical-network-analysis.html"><a href="graphical-network-analysis.html"><i class="fa fa-check"></i><b>27</b> Graphical Network Analysis</a>
<ul>
<li class="chapter" data-level="27.1" data-path="graphical-network-analysis.html"><a href="graphical-network-analysis.html#fundementals"><i class="fa fa-check"></i><b>27.1</b> Fundementals</a></li>
<li class="chapter" data-level="27.2" data-path="graphical-network-analysis.html"><a href="graphical-network-analysis.html#covariance"><i class="fa fa-check"></i><b>27.2</b> Covariance</a></li>
<li class="chapter" data-level="27.3" data-path="graphical-network-analysis.html"><a href="graphical-network-analysis.html#correlation-1"><i class="fa fa-check"></i><b>27.3</b> Correlation</a></li>
<li class="chapter" data-level="27.4" data-path="graphical-network-analysis.html"><a href="graphical-network-analysis.html#precision-matrix"><i class="fa fa-check"></i><b>27.4</b> Precision Matrix</a></li>
<li class="chapter" data-level="27.5" data-path="graphical-network-analysis.html"><a href="graphical-network-analysis.html#semi-partial-correlation"><i class="fa fa-check"></i><b>27.5</b> Semi-partial Correlation</a></li>
<li class="chapter" data-level="27.6" data-path="graphical-network-analysis.html"><a href="graphical-network-analysis.html#regularized-covariance-matrix"><i class="fa fa-check"></i><b>27.6</b> Regularized Covariance Matrix</a></li>
<li class="chapter" data-level="27.7" data-path="graphical-network-analysis.html"><a href="graphical-network-analysis.html#multivariate-gaussian-distribution"><i class="fa fa-check"></i><b>27.7</b> Multivariate Gaussian Distribution</a></li>
<li class="chapter" data-level="27.8" data-path="graphical-network-analysis.html"><a href="graphical-network-analysis.html#high-dimensional-data"><i class="fa fa-check"></i><b>27.8</b> High-dimensional data</a></li>
<li class="chapter" data-level="27.9" data-path="graphical-network-analysis.html"><a href="graphical-network-analysis.html#ridge-ell_2-and-glasso-ell_1"><i class="fa fa-check"></i><b>27.9</b> Ridge (<span class="math inline">\(\ell_{2}\)</span>) and glasso (<span class="math inline">\(\ell_{1}\)</span>)</a></li>
</ul></li>
<li class="chapter" data-level="28" data-path="decompositions.html"><a href="decompositions.html"><i class="fa fa-check"></i><b>28</b> Decompositions</a>
<ul>
<li class="chapter" data-level="28.1" data-path="decompositions.html"><a href="decompositions.html#matrix-decomposition"><i class="fa fa-check"></i><b>28.1</b> Matrix Decomposition</a></li>
<li class="chapter" data-level="28.2" data-path="decompositions.html"><a href="decompositions.html#eigenvectors-and-eigenvalues"><i class="fa fa-check"></i><b>28.2</b> Eigenvectors and eigenvalues</a></li>
<li class="chapter" data-level="28.3" data-path="decompositions.html"><a href="decompositions.html#singular-value-decomposition"><i class="fa fa-check"></i><b>28.3</b> Singular Value Decomposition</a></li>
<li class="chapter" data-level="28.4" data-path="decompositions.html"><a href="decompositions.html#rankr-approximations"><i class="fa fa-check"></i><b>28.4</b> Rank(r) Approximations</a></li>
<li class="chapter" data-level="28.5" data-path="decompositions.html"><a href="decompositions.html#moore-penrose-inverse"><i class="fa fa-check"></i><b>28.5</b> Moore-Penrose inverse</a></li>
</ul></li>
<li class="chapter" data-level="29" data-path="pca-principle-component-analysis.html"><a href="pca-principle-component-analysis.html"><i class="fa fa-check"></i><b>29</b> PCA (Principle Component Analysis)</a>
<ul>
<li class="chapter" data-level="29.1" data-path="pca-principle-component-analysis.html"><a href="pca-principle-component-analysis.html#factor-analysis"><i class="fa fa-check"></i><b>29.1</b> Factor Analysis</a></li>
</ul></li>
<li class="chapter" data-level="30" data-path="smoothing.html"><a href="smoothing.html"><i class="fa fa-check"></i><b>30</b> Smoothing</a>
<ul>
<li class="chapter" data-level="30.1" data-path="smoothing.html"><a href="smoothing.html#using-bins"><i class="fa fa-check"></i><b>30.1</b> Using bins</a></li>
<li class="chapter" data-level="30.2" data-path="smoothing.html"><a href="smoothing.html#kernel-smoothing"><i class="fa fa-check"></i><b>30.2</b> Kernel smoothing</a></li>
<li class="chapter" data-level="30.3" data-path="smoothing.html"><a href="smoothing.html#locally-weighted-regression-loess"><i class="fa fa-check"></i><b>30.3</b> Locally weighted regression <code>loess()</code></a></li>
<li class="chapter" data-level="30.4" data-path="smoothing.html"><a href="smoothing.html#smooth-spline-regression"><i class="fa fa-check"></i><b>30.4</b> Smooth Spline Regression</a></li>
<li class="chapter" data-level="30.5" data-path="smoothing.html"><a href="smoothing.html#multivariate-loess"><i class="fa fa-check"></i><b>30.5</b> Multivariate Loess</a></li>
</ul></li>
<li class="chapter" data-level="31" data-path="imbalanced-data.html"><a href="imbalanced-data.html"><i class="fa fa-check"></i><b>31</b> Imbalanced Data</a>
<ul>
<li class="chapter" data-level="31.1" data-path="imbalanced-data.html"><a href="imbalanced-data.html#smote"><i class="fa fa-check"></i><b>31.1</b> <code>SMOTE</code></a></li>
<li class="chapter" data-level="31.2" data-path="imbalanced-data.html"><a href="imbalanced-data.html#fraud-detection"><i class="fa fa-check"></i><b>31.2</b> Fraud detection</a></li>
</ul></li>
<li class="chapter" data-level="32" data-path="text-analysis.html"><a href="text-analysis.html"><i class="fa fa-check"></i><b>32</b> Text Analysis</a></li>
<li class="chapter" data-level="33" data-path="other-nonparametric-estimation-methods.html"><a href="other-nonparametric-estimation-methods.html"><i class="fa fa-check"></i><b>33</b> Other Nonparametric Estimation methods</a>
<ul>
<li class="chapter" data-level="33.1" data-path="other-nonparametric-estimation-methods.html"><a href="other-nonparametric-estimation-methods.html#other-nonparametric-estimation-methods-1"><i class="fa fa-check"></i><b>33.1</b> Other Nonparametric Estimation methods</a></li>
<li class="chapter" data-level="33.2" data-path="other-nonparametric-estimation-methods.html"><a href="other-nonparametric-estimation-methods.html#regression-splines"><i class="fa fa-check"></i><b>33.2</b> Regression splines</a></li>
<li class="chapter" data-level="33.3" data-path="other-nonparametric-estimation-methods.html"><a href="other-nonparametric-estimation-methods.html#mars"><i class="fa fa-check"></i><b>33.3</b> MARS</a></li>
<li class="chapter" data-level="33.4" data-path="other-nonparametric-estimation-methods.html"><a href="other-nonparametric-estimation-methods.html#gam"><i class="fa fa-check"></i><b>33.4</b> GAM</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/mutluyuk/machinemetrics" target="blank">2023 Initial Draft</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">MachineMetrics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="forecast" class="section level1 hasAnchor" number="23">
<h1><span class="header-section-number">Chapter 23</span> Forecast<a href="forecast.html#forecast" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="time-series-embedding" class="section level2 hasAnchor" number="23.1">
<h2><span class="header-section-number">23.1</span> Time Series Embedding<a href="forecast.html#time-series-embedding" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In general, forecasting models use either direct or recursive forecasting, or their combinations (See <a href="https://robjhyndman.com/papers/rectify.pdf">Taieb and Hyndman</a>, 2012). The difference between these two methods is related to discussion on prediction accuracy and forecasting variance.</p>
<p>Recursive forecasting requires a parametric model and would face increasing forecasting error when the underlying model is not linear. Direct forecasting, however, can be achieved by a nonparametric predictive algorithm, while it may have a higher variance as the forecast horizon gets longer.</p>
<p>Multi-period recursive forecasting use a single time series model, like AR(1). With iterative substitutions of the estimated model, any forecast period of <span class="math inline">\(h\)</span> can be computed. Let’s start with a simple AR(1) to see recursive forecasting:</p>
<p><span class="math display">\[
x_{t+1}=\alpha_0+\phi_1 x_t+\epsilon_{t}
\]</span></p>
<p>If we use this AR(1) to have a 3-period forecast:</p>
<p><span class="math display">\[
\hat{x}_{t+1}=\hat{\alpha}_0+\hat{\phi}_1 x_t, \\
\hat{x}_{t+2}=\hat{\alpha}_0+\hat{\phi}_1 \hat{x}_{t+1}, \\
\hat{x}_{t+3}=\hat{\alpha}_0+\hat{\phi}_1 \hat{x}_{t+2}
\]</span>
With iterative substitutions:</p>
<p><span class="math display">\[
\hat{x}_{t+1}=\hat{\alpha}_0+\hat{\phi}_1 x_t ~~~~ 1^{st} ~ \text{Period}\\
\hat{x}_{t+2}=\hat{\alpha}_0+\hat{\alpha}_0\hat{\alpha}_1+\hat{\phi}^2_1 x_{t} ~~~~ 2^{nd} ~ \text{Period}\\
\hat{x}_{t+3}=\hat{\alpha}_0+\hat{\alpha}_0\hat{\alpha}_1+\hat{\alpha}_0\hat{\alpha}^2_1+\hat{\phi}^3_1 x_t~~~~ 3^{rd} ~ \text{Period}
\]</span></p>
<p>Of course, we can generalize it for <span class="math inline">\(h\)</span> periods:</p>
<p><span class="math display">\[
\hat{x}_{t+h}=\hat{\alpha}_0 \sum_{i=1}^h \hat{\phi}_1^{i-1}+\hat{\phi}_1^h x_t
\]</span></p>
<p>The estimated coefficients (<span class="math inline">\(\hat{\alpha}_0\)</span>, <span class="math inline">\(\hat{\phi}_1\)</span>) are the same; hence, we need only one model for any period.</p>
<p>Alternatively, we can apply the direct multi-period forecasting, where a separate predictive model for each forecasting horizon between <span class="math inline">\(h\)</span> and <span class="math inline">\(t\)</span> is estimated. Here is the example with AR(1):</p>
<p><span class="math display">\[
x_{t+1}=\alpha_0+\alpha_1 x_t+\epsilon_{t}, \\
x_{t+2}=\beta_0+\beta_1 x_t+\epsilon_{t}, \\
x_{t+3}=\omega_0+\omega_1 x_t+\epsilon_{t}. \\
\]</span></p>
<p>And, the 3-period direct forecasts with three different models:</p>
<p><span class="math display">\[
\hat{x}_{t+1}=\hat{\alpha}_0+\hat{\alpha}_1 x_t ~~~~ 1^{st} ~ \text{Period}\\
\hat{x}_{t+2}=\hat{\beta}_0+\hat{\beta}_1 x_{t} ~~~~ 2^{nd} ~ \text{Period}\\
\hat{x}_{t+3}=\hat{\omega}_0+\hat{\omega}_1x_t~~~~ 3^{rd} ~ \text{Period}
\]</span></p>
</div>
<div id="var-for-recursive-forecasting" class="section level2 hasAnchor" number="23.2">
<h2><span class="header-section-number">23.2</span> VAR for Recursive Forecasting<a href="forecast.html#var-for-recursive-forecasting" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The problem with a multi-period recursive forecasting becomes clear when we have multivariate model:</p>
<p><span class="math display">\[
y_{t+1}=\beta_0+\beta_1 y_t+\beta_2x_t+\epsilon_{t}
\]</span></p>
<p>If we want a 2-period forecast,</p>
<p><span class="math display">\[
\hat{y}_{t+2}=\hat{\beta}_0+\hat{\beta}_1 \hat{y}_{t+1}+\hat{\beta}_2 \hat{x}_{t+1},
\]</span></p>
<p>Hence, <span class="math inline">\(\hat{x}_{t+1}\)</span> has to be estimated. This can be done with a Vector Autorregressive (VAR) framework. A VAR model consists of multiple equations, one per variable. Each equation includes a constant and lags of all of the variables in the system.</p>
<p><span class="math display">\[
\begin{aligned}
&amp; y_{t}=c_1+\beta_{1} y_{t-1}+\beta_{2} x_{t-1}+\varepsilon_{t} \\
&amp; x_{t}=c_2+\phi_{1} x_{t-1}+\phi_{2} y_{t-1}+e_{t}
\end{aligned}
\]</span></p>
<p>Each model is estimated using the principle of ordinary least squares, given that series are stationary. Forecasts in VAR are calculated with recursive iterations. Therefore, the set of equations generates forecasts for each variable. To decide the number of lags in each equation, the BIC is used.</p>
<p>Let’s have our COVID-19 data and include the mobility to our forecasting model.</p>
<div class="sourceCode" id="cb703"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb703-1"><a href="forecast.html#cb703-1" tabindex="-1"></a><span class="fu">library</span>(tsibble)</span>
<span id="cb703-2"><a href="forecast.html#cb703-2" tabindex="-1"></a><span class="fu">library</span>(fpp3)</span>
<span id="cb703-3"><a href="forecast.html#cb703-3" tabindex="-1"></a></span>
<span id="cb703-4"><a href="forecast.html#cb703-4" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;dftoronto.RData&quot;</span>)</span>
<span id="cb703-5"><a href="forecast.html#cb703-5" tabindex="-1"></a>day <span class="ot">&lt;-</span> <span class="fu">seq.Date</span>(</span>
<span id="cb703-6"><a href="forecast.html#cb703-6" tabindex="-1"></a>  <span class="at">from =</span> <span class="fu">as.Date</span>(<span class="st">&quot;2020/03/01&quot;</span>),</span>
<span id="cb703-7"><a href="forecast.html#cb703-7" tabindex="-1"></a>  <span class="at">to =</span> <span class="fu">as.Date</span>(<span class="st">&quot;2020/11/21&quot;</span>),</span>
<span id="cb703-8"><a href="forecast.html#cb703-8" tabindex="-1"></a>  <span class="at">by =</span> <span class="dv">1</span></span>
<span id="cb703-9"><a href="forecast.html#cb703-9" tabindex="-1"></a>)</span>
<span id="cb703-10"><a href="forecast.html#cb703-10" tabindex="-1"></a></span>
<span id="cb703-11"><a href="forecast.html#cb703-11" tabindex="-1"></a>tdata <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Day =</span> day,</span>
<span id="cb703-12"><a href="forecast.html#cb703-12" tabindex="-1"></a>                <span class="at">mob =</span> data<span class="sc">$</span>mob,</span>
<span id="cb703-13"><a href="forecast.html#cb703-13" tabindex="-1"></a>                <span class="at">cases =</span> data<span class="sc">$</span>cases)</span>
<span id="cb703-14"><a href="forecast.html#cb703-14" tabindex="-1"></a></span>
<span id="cb703-15"><a href="forecast.html#cb703-15" tabindex="-1"></a>toronto <span class="ot">&lt;-</span> tdata <span class="sc">%&gt;%</span></span>
<span id="cb703-16"><a href="forecast.html#cb703-16" tabindex="-1"></a>  <span class="fu">as_tsibble</span>(<span class="at">index =</span> Day)</span>
<span id="cb703-17"><a href="forecast.html#cb703-17" tabindex="-1"></a></span>
<span id="cb703-18"><a href="forecast.html#cb703-18" tabindex="-1"></a>toronto</span></code></pre></div>
<pre><code>## # A tsibble: 266 x 3 [1D]
##    Day             mob cases
##    &lt;date&gt;        &lt;dbl&gt; &lt;dbl&gt;
##  1 2020-03-01 -0.0172      4
##  2 2020-03-02 -0.0320      6
##  3 2020-03-03 -0.0119     10
##  4 2020-03-04  0.0186      7
##  5 2020-03-05  0.0223      7
##  6 2020-03-06 -0.00626    10
##  7 2020-03-07  0.0261      8
##  8 2020-03-08  0.0273     10
##  9 2020-03-09 -0.0158     18
## 10 2020-03-10 -0.0521     29
## # ℹ 256 more rows</code></pre>
<p>We will estimate the recursive forecasts for 1 to 14 days ahead.</p>
<div class="sourceCode" id="cb705"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb705-1"><a href="forecast.html#cb705-1" tabindex="-1"></a><span class="co"># We need make series stationary</span></span>
<span id="cb705-2"><a href="forecast.html#cb705-2" tabindex="-1"></a>trdf <span class="ot">&lt;-</span> toronto <span class="sc">%&gt;%</span></span>
<span id="cb705-3"><a href="forecast.html#cb705-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diffcases =</span> <span class="fu">difference</span>(cases),</span>
<span id="cb705-4"><a href="forecast.html#cb705-4" tabindex="-1"></a>         <span class="at">diffmob =</span> <span class="fu">difference</span>(mob))</span>
<span id="cb705-5"><a href="forecast.html#cb705-5" tabindex="-1"></a></span>
<span id="cb705-6"><a href="forecast.html#cb705-6" tabindex="-1"></a><span class="co"># VAR with BIC</span></span>
<span id="cb705-7"><a href="forecast.html#cb705-7" tabindex="-1"></a>fit <span class="ot">&lt;-</span> trdf[<span class="sc">-</span><span class="dv">1</span>, ] <span class="sc">%&gt;%</span></span>
<span id="cb705-8"><a href="forecast.html#cb705-8" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">VAR</span>(<span class="fu">vars</span>(diffcases, diffmob), <span class="at">ic =</span> <span class="st">&quot;bic&quot;</span>))</span>
<span id="cb705-9"><a href="forecast.html#cb705-9" tabindex="-1"></a><span class="fu">glance</span>(fit)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 6
##   .model                                      sigma2   log_lik   AIC  AICc   BIC
##   &lt;chr&gt;                                       &lt;list&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 &quot;VAR(vars(diffcases, diffmob), ic = \&quot;bic\… &lt;dbl[…]&gt;   -854. 1755. 1760. 1841.</code></pre>
<div class="sourceCode" id="cb707"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb707-1"><a href="forecast.html#cb707-1" tabindex="-1"></a>fit <span class="sc">%&gt;%</span> <span class="fu">report</span>()</span></code></pre></div>
<pre><code>## Series: diffcases, diffmob 
## Model: VAR(5) 
## 
## Coefficients for diffcases:
##       lag(diffcases,1)  lag(diffmob,1)  lag(diffcases,2)  lag(diffmob,2)
##                -0.4074       -105.6524           -0.0703         11.0374
## s.e.            0.0639         28.3643            0.0695         29.9761
##       lag(diffcases,3)  lag(diffmob,3)  lag(diffcases,4)  lag(diffmob,4)
##                 0.0528         10.8093           -0.0123         -4.8989
## s.e.            0.0701         31.8601            0.0713         30.0019
##       lag(diffcases,5)  lag(diffmob,5)
##                 0.0227          6.1099
## s.e.            0.0640         29.2678
## 
## Coefficients for diffmob:
##       lag(diffcases,1)  lag(diffmob,1)  lag(diffcases,2)  lag(diffmob,2)
##                  0e+00          -0.314             0e+00         -0.4688
## s.e.             1e-04           0.057             1e-04          0.0603
##       lag(diffcases,3)  lag(diffmob,3)  lag(diffcases,4)  lag(diffmob,4)
##                  1e-04         -0.2931            -1e-04         -0.2664
## s.e.             1e-04          0.0641             1e-04          0.0603
##       lag(diffcases,5)  lag(diffmob,5)
##                  3e-04         -0.4059
## s.e.             1e-04          0.0588
## 
## Residual covariance matrix:
##           diffcases diffmob
## diffcases  811.6771 -0.1648
## diffmob     -0.1648  0.0033
## 
## log likelihood = -853.64
## AIC = 1755.28    AICc = 1760.38  BIC = 1840.73</code></pre>
<div class="sourceCode" id="cb709"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb709-1"><a href="forecast.html#cb709-1" tabindex="-1"></a>fit <span class="sc">%&gt;%</span></span>
<span id="cb709-2"><a href="forecast.html#cb709-2" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">14</span>) <span class="sc">%&gt;%</span></span>
<span id="cb709-3"><a href="forecast.html#cb709-3" tabindex="-1"></a>  <span class="fu">autoplot</span>(trdf[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">200</span>), ])</span></code></pre></div>
<p><img src="23-Forecast_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>We should have transformed both series by the Box-Cox transformation, but we ignored it above.</p>
</div>
<div id="embedding-for-direct-forecast" class="section level2 hasAnchor" number="23.3">
<h2><span class="header-section-number">23.3</span> Embedding for Direct Forecast<a href="forecast.html#embedding-for-direct-forecast" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For direct forecasting, we need to rearrange the data in a way that we can estimate 7 models for forecasting ahead each day of 7 days. We will use <code>embed()</code> function to show what we mean with rearranging data for AR(3), for example:</p>
<div class="sourceCode" id="cb710"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb710-1"><a href="forecast.html#cb710-1" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb710-2"><a href="forecast.html#cb710-2" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">embed</span>(Y, <span class="dv">3</span>)</span>
<span id="cb710-3"><a href="forecast.html#cb710-3" tabindex="-1"></a><span class="fu">colnames</span>(Y) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Y(t)&quot;</span>, <span class="st">&quot;Y(t-1)&quot;</span>, <span class="st">&quot;Y(t-2)&quot;</span>)</span>
<span id="cb710-4"><a href="forecast.html#cb710-4" tabindex="-1"></a>Y</span></code></pre></div>
<pre><code>##      Y(t) Y(t-1) Y(t-2)
## [1,]    3      2      1
## [2,]    4      3      2
## [3,]    5      4      3
## [4,]    6      5      4
## [5,]    7      6      5
## [6,]    8      7      6
## [7,]    9      8      7
## [8,]   10      9      8</code></pre>
<p>Now, the key point is that there is no a temporal dependence between each row so that shuffling this data after re-structuring it admissible. Let’s have an AR(1) example on this simulated data</p>
<div class="sourceCode" id="cb712"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb712-1"><a href="forecast.html#cb712-1" tabindex="-1"></a><span class="co"># Stationary data rho &lt; 1 but = 0.85</span></span>
<span id="cb712-2"><a href="forecast.html#cb712-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb712-3"><a href="forecast.html#cb712-3" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="fl">0.85</span></span>
<span id="cb712-4"><a href="forecast.html#cb712-4" tabindex="-1"></a></span>
<span id="cb712-5"><a href="forecast.html#cb712-5" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, n)</span>
<span id="cb712-6"><a href="forecast.html#cb712-6" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">345</span>)</span>
<span id="cb712-7"><a href="forecast.html#cb712-7" tabindex="-1"></a>eps <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb712-8"><a href="forecast.html#cb712-8" tabindex="-1"></a></span>
<span id="cb712-9"><a href="forecast.html#cb712-9" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb712-10"><a href="forecast.html#cb712-10" tabindex="-1"></a>  y[j <span class="sc">+</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> y[j] <span class="sc">*</span> rho <span class="sc">+</span> eps[j]</span>
<span id="cb712-11"><a href="forecast.html#cb712-11" tabindex="-1"></a>}</span>
<span id="cb712-12"><a href="forecast.html#cb712-12" tabindex="-1"></a></span>
<span id="cb712-13"><a href="forecast.html#cb712-13" tabindex="-1"></a>ylagged <span class="ot">&lt;-</span> y[<span class="dv">2</span><span class="sc">:</span>n]</span>
<span id="cb712-14"><a href="forecast.html#cb712-14" tabindex="-1"></a></span>
<span id="cb712-15"><a href="forecast.html#cb712-15" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb712-16"><a href="forecast.html#cb712-16" tabindex="-1"></a><span class="fu">plot</span>(ylagged,</span>
<span id="cb712-17"><a href="forecast.html#cb712-17" tabindex="-1"></a>     y[<span class="dv">1</span><span class="sc">:</span>(n <span class="sc">-</span> <span class="dv">1</span>)],</span>
<span id="cb712-18"><a href="forecast.html#cb712-18" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;lightpink&quot;</span>,</span>
<span id="cb712-19"><a href="forecast.html#cb712-19" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb712-20"><a href="forecast.html#cb712-20" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;y(t-1)&quot;</span>)</span>
<span id="cb712-21"><a href="forecast.html#cb712-21" tabindex="-1"></a><span class="fu">plot</span>(y[<span class="dv">1</span><span class="sc">:</span><span class="dv">500</span>],</span>
<span id="cb712-22"><a href="forecast.html#cb712-22" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb712-23"><a href="forecast.html#cb712-23" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb712-24"><a href="forecast.html#cb712-24" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb712-25"><a href="forecast.html#cb712-25" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;t&quot;</span></span>
<span id="cb712-26"><a href="forecast.html#cb712-26" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="23-Forecast_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>We will use an AR(1) estimation with OLS after embedding:</p>
<div class="sourceCode" id="cb713"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb713-1"><a href="forecast.html#cb713-1" tabindex="-1"></a><span class="fu">head</span>(y)</span></code></pre></div>
<pre><code>## [1]  0.0000000 -0.7849082 -0.9466863 -0.9661413 -1.1118166 -1.0125757</code></pre>
<div class="sourceCode" id="cb715"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb715-1"><a href="forecast.html#cb715-1" tabindex="-1"></a>y_em <span class="ot">&lt;-</span> <span class="fu">embed</span>(y, <span class="dv">2</span>)</span>
<span id="cb715-2"><a href="forecast.html#cb715-2" tabindex="-1"></a><span class="fu">colnames</span>(y_em) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;yt&quot;</span>, <span class="st">&quot;yt_1&quot;</span>)</span>
<span id="cb715-3"><a href="forecast.html#cb715-3" tabindex="-1"></a><span class="fu">head</span>(y_em)</span></code></pre></div>
<pre><code>##              yt       yt_1
## [1,] -0.7849082  0.0000000
## [2,] -0.9466863 -0.7849082
## [3,] -0.9661413 -0.9466863
## [4,] -1.1118166 -0.9661413
## [5,] -1.0125757 -1.1118166
## [6,] -1.4942098 -1.0125757</code></pre>
<p>And estimation of AR(1) with OLS:</p>
<div class="sourceCode" id="cb717"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb717-1"><a href="forecast.html#cb717-1" tabindex="-1"></a>y_em <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y_em)</span>
<span id="cb717-2"><a href="forecast.html#cb717-2" tabindex="-1"></a>ar1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(yt <span class="sc">~</span> yt_1 <span class="sc">-</span> <span class="dv">1</span>, y_em)</span>
<span id="cb717-3"><a href="forecast.html#cb717-3" tabindex="-1"></a>ar1</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = yt ~ yt_1 - 1, data = y_em)
## 
## Coefficients:
##   yt_1  
## 0.8496</code></pre>
<p>Now, let’s shuffle <code>y_em</code>:</p>
<div class="sourceCode" id="cb719"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb719-1"><a href="forecast.html#cb719-1" tabindex="-1"></a><span class="co"># Shuffle</span></span>
<span id="cb719-2"><a href="forecast.html#cb719-2" tabindex="-1"></a>ind <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(y_em), <span class="fu">nrow</span>(y_em), <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb719-3"><a href="forecast.html#cb719-3" tabindex="-1"></a>y_em_sh <span class="ot">&lt;-</span> y_em[ind, ]</span>
<span id="cb719-4"><a href="forecast.html#cb719-4" tabindex="-1"></a></span>
<span id="cb719-5"><a href="forecast.html#cb719-5" tabindex="-1"></a>ar1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(yt <span class="sc">~</span> yt_1 <span class="sc">-</span> <span class="dv">1</span>, y_em_sh)</span>
<span id="cb719-6"><a href="forecast.html#cb719-6" tabindex="-1"></a>ar1</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = yt ~ yt_1 - 1, data = y_em_sh)
## 
## Coefficients:
##   yt_1  
## 0.8496</code></pre>
<p>This application shows the temporal independence across the observations in the rearranged data give that model (AR) is correctly specified. This is important because we can use conventional machine learning applications on time series data, like random forests, which we see in the next chapter.</p>
<p>This re-arrangement can also be applied to multivariate data sets:</p>
<div class="sourceCode" id="cb721"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb721-1"><a href="forecast.html#cb721-1" tabindex="-1"></a>tsdf <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">21</span><span class="sc">:</span><span class="dv">30</span>), <span class="at">nrow =</span> <span class="dv">10</span>)</span>
<span id="cb721-2"><a href="forecast.html#cb721-2" tabindex="-1"></a><span class="fu">colnames</span>(tsdf) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Y&quot;</span>, <span class="st">&quot;X&quot;</span>)</span>
<span id="cb721-3"><a href="forecast.html#cb721-3" tabindex="-1"></a>first <span class="ot">&lt;-</span> <span class="fu">embed</span>(tsdf, <span class="dv">3</span>)</span>
<span id="cb721-4"><a href="forecast.html#cb721-4" tabindex="-1"></a><span class="fu">colnames</span>(first) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;y(t)&quot;</span>,<span class="st">&quot;x(t)&quot;</span>,<span class="st">&quot;y(t-1)&quot;</span>,<span class="st">&quot;x(t-1)&quot;</span>, <span class="st">&quot;y(t-2)&quot;</span>, <span class="st">&quot;x(t-2)&quot;</span>)</span>
<span id="cb721-5"><a href="forecast.html#cb721-5" tabindex="-1"></a><span class="fu">head</span>(first)</span></code></pre></div>
<pre><code>##      y(t) x(t) y(t-1) x(t-1) y(t-2) x(t-2)
## [1,]    3   23      2     22      1     21
## [2,]    4   24      3     23      2     22
## [3,]    5   25      4     24      3     23
## [4,]    6   26      5     25      4     24
## [5,]    7   27      6     26      5     25
## [6,]    8   28      7     27      6     26</code></pre>
<p>Now, we need to have three models for three forecasting horizons. Here are these models:</p>
<p><span class="math display">\[
\hat{y}_{t+1}=\hat{\alpha}_0+\hat{\alpha}_1 y_t + \hat{\alpha}_2 y_{t-1}+ \hat{\alpha}_3 x_t + \hat{\alpha}_4 x_{t-1}+ \hat{\alpha}_5 x_{t-2} ~~~~ 1^{st} ~ \text{Period}\\
\hat{y}_{t+2}=\hat{\beta}_0+\hat{\beta}_1 y_t + \hat{\beta}_2 y_{t-1}+ \hat{\beta}_3 x_t + \hat{\beta}_4 x_{t-1}+ \hat{\beta}_5 x_{t-2} ~~~~ 2^{nd} ~ \text{Period}\\
\hat{y}_{t+3}=\hat{\omega}_0+\hat{\omega}_1 y_t + \hat{\omega}_2 y_{t-1}+ \hat{\omega}_3 x_t + \hat{\omega}_4 x_{t-1}+ \hat{\omega}_5 x_{t-2} ~~~~ 3^{rd} ~ \text{Period}
\]</span>
Each one of these models requires a different rearrangement in the data. Here are the required arrangement for each model:</p>
<pre><code>##      y(t) x(t) y(t-1) x(t-1) y(t-2) x(t-2)
## [1,]    3   23      2     22      1     21
## [2,]    4   24      3     23      2     22
## [3,]    5   25      4     24      3     23
## [4,]    6   26      5     25      4     24
## [5,]    7   27      6     26      5     25
## [6,]    8   28      7     27      6     26</code></pre>
<pre><code>##      y(t) x(t-1) y(t-2) x(t-2) y(t-3) x(t-3)
## [1,]    4     23      2     22      1     21
## [2,]    5     24      3     23      2     22
## [3,]    6     25      4     24      3     23
## [4,]    7     26      5     25      4     24
## [5,]    8     27      6     26      5     25
## [6,]    9     28      7     27      6     26</code></pre>
<pre><code>##      y(t) x(t-2) y(t-3) x(t-3) y(t-4) x(t-4)
## [1,]    5     23      2     22      1     21
## [2,]    6     24      3     23      2     22
## [3,]    7     25      4     24      3     23
## [4,]    8     26      5     25      4     24
## [5,]    9     27      6     26      5     25
## [6,]   10     28      7     27      6     26</code></pre>
<p>We already rearranged the data for the first model. if we remove the first row in <code>y(t)</code> and the last row in the remaining set, we can get the data for the second model:</p>
<div class="sourceCode" id="cb726"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb726-1"><a href="forecast.html#cb726-1" tabindex="-1"></a><span class="fu">cbind</span>(first[<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>], first[<span class="sc">-</span><span class="fu">nrow</span>(first),<span class="sc">-</span><span class="dv">1</span>])</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4] [,5] [,6]
## [1,]    4   23    2   22    1   21
## [2,]    5   24    3   23    2   22
## [3,]    6   25    4   24    3   23
## [4,]    7   26    5   25    4   24
## [5,]    8   27    6   26    5   25
## [6,]    9   28    7   27    6   26
## [7,]   10   29    8   28    7   27</code></pre>
<p>We will use our COVID-19 data and a simple linear regression as an example of direct forecasting:</p>
<div class="sourceCode" id="cb728"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb728-1"><a href="forecast.html#cb728-1" tabindex="-1"></a><span class="co"># Preparing data</span></span>
<span id="cb728-2"><a href="forecast.html#cb728-2" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">dcases =</span> trdf<span class="sc">$</span>diffcases, <span class="at">dmob =</span> trdf<span class="sc">$</span>diffmob)</span>
<span id="cb728-3"><a href="forecast.html#cb728-3" tabindex="-1"></a>df <span class="ot">&lt;-</span> df[<span class="fu">complete.cases</span>(df),]</span>
<span id="cb728-4"><a href="forecast.html#cb728-4" tabindex="-1"></a><span class="fu">rownames</span>(df) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb728-5"><a href="forecast.html#cb728-5" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(df)</span>
<span id="cb728-6"><a href="forecast.html#cb728-6" tabindex="-1"></a><span class="fu">head</span>(df)</span></code></pre></div>
<pre><code>##      dcases     dmob
## [1,]      2 -0.01480
## [2,]      4  0.02013
## [3,]     -3  0.03049
## [4,]      0  0.00367
## [5,]      3 -0.02854
## [6,]     -2  0.03232</code></pre>
<p>Now we need to decide on two parameters: the window size, that is, how many lags will be included in each row; and how many days we will forecast. The next section will use more advance functions for re-arranging the data and apply the direct forecasting with random forests. For now, let’s use a 3-day window and a 3-day forecast horizon:</p>
<div class="sourceCode" id="cb730"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb730-1"><a href="forecast.html#cb730-1" tabindex="-1"></a>h <span class="ot">=</span> <span class="dv">3</span></span>
<span id="cb730-2"><a href="forecast.html#cb730-2" tabindex="-1"></a>w <span class="ot">=</span> <span class="dv">3</span></span>
<span id="cb730-3"><a href="forecast.html#cb730-3" tabindex="-1"></a>fh <span class="ot">&lt;-</span> <span class="fu">c</span>() <span class="co"># storage for forecast</span></span>
<span id="cb730-4"><a href="forecast.html#cb730-4" tabindex="-1"></a></span>
<span id="cb730-5"><a href="forecast.html#cb730-5" tabindex="-1"></a><span class="co"># Start with first</span></span>
<span id="cb730-6"><a href="forecast.html#cb730-6" tabindex="-1"></a>dt <span class="ot">&lt;-</span> <span class="fu">embed</span>(df, w)</span>
<span id="cb730-7"><a href="forecast.html#cb730-7" tabindex="-1"></a>y <span class="ot">&lt;-</span> dt[, <span class="dv">1</span>]</span>
<span id="cb730-8"><a href="forecast.html#cb730-8" tabindex="-1"></a>X <span class="ot">&lt;-</span> dt[, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb730-9"><a href="forecast.html#cb730-9" tabindex="-1"></a></span>
<span id="cb730-10"><a href="forecast.html#cb730-10" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>h) {</span>
<span id="cb730-11"><a href="forecast.html#cb730-11" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> X)</span>
<span id="cb730-12"><a href="forecast.html#cb730-12" tabindex="-1"></a>  l <span class="ot">&lt;-</span> <span class="fu">length</span>(fit<span class="sc">$</span>fitted.values)</span>
<span id="cb730-13"><a href="forecast.html#cb730-13" tabindex="-1"></a>  fh[i] <span class="ot">&lt;-</span> fit<span class="sc">$</span>fitted.values[l]</span>
<span id="cb730-14"><a href="forecast.html#cb730-14" tabindex="-1"></a>  y <span class="ot">&lt;-</span> y[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb730-15"><a href="forecast.html#cb730-15" tabindex="-1"></a>  X <span class="ot">&lt;-</span> X[<span class="sc">-</span><span class="fu">nrow</span>(X), ]</span>
<span id="cb730-16"><a href="forecast.html#cb730-16" tabindex="-1"></a>}</span>
<span id="cb730-17"><a href="forecast.html#cb730-17" tabindex="-1"></a></span>
<span id="cb730-18"><a href="forecast.html#cb730-18" tabindex="-1"></a>fh</span></code></pre></div>
<pre><code>## [1]  10.288416 -11.587090   0.302522</code></pre>
<div class="sourceCode" id="cb732"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb732-1"><a href="forecast.html#cb732-1" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">266</span>, trdf<span class="sc">$</span>diffcases, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span>
<span id="cb732-2"><a href="forecast.html#cb732-2" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">267</span><span class="sc">:</span><span class="dv">269</span>, fh, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="23-Forecast_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p>We haven’t used training and test sets above. If we apply a proper splitting, we can even set the window size as our hyperparameter to minimize the forecast error:</p>
<div class="sourceCode" id="cb733"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb733-1"><a href="forecast.html#cb733-1" tabindex="-1"></a><span class="co"># We set the last 7 days as our test set</span></span>
<span id="cb733-2"><a href="forecast.html#cb733-2" tabindex="-1"></a>train <span class="ot">&lt;-</span> df[<span class="dv">1</span><span class="sc">:</span><span class="dv">258</span>,]</span>
<span id="cb733-3"><a href="forecast.html#cb733-3" tabindex="-1"></a>test <span class="ot">&lt;-</span> df[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">258</span>),]</span>
<span id="cb733-4"><a href="forecast.html#cb733-4" tabindex="-1"></a></span>
<span id="cb733-5"><a href="forecast.html#cb733-5" tabindex="-1"></a>h <span class="ot">=</span> <span class="dv">7</span></span>
<span id="cb733-6"><a href="forecast.html#cb733-6" tabindex="-1"></a>w <span class="ot">&lt;-</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">14</span> <span class="co"># a grid for window size</span></span>
<span id="cb733-7"><a href="forecast.html#cb733-7" tabindex="-1"></a></span>
<span id="cb733-8"><a href="forecast.html#cb733-8" tabindex="-1"></a>fh <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="fu">length</span>(w), h)</span>
<span id="cb733-9"><a href="forecast.html#cb733-9" tabindex="-1"></a><span class="fu">rownames</span>(fh) <span class="ot">&lt;-</span> w</span>
<span id="cb733-10"><a href="forecast.html#cb733-10" tabindex="-1"></a><span class="fu">colnames</span>(fh) <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span></span>
<span id="cb733-11"><a href="forecast.html#cb733-11" tabindex="-1"></a></span>
<span id="cb733-12"><a href="forecast.html#cb733-12" tabindex="-1"></a><span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(w)) {</span>
<span id="cb733-13"><a href="forecast.html#cb733-13" tabindex="-1"></a>  dt <span class="ot">&lt;-</span> <span class="fu">embed</span>(train, w[s])</span>
<span id="cb733-14"><a href="forecast.html#cb733-14" tabindex="-1"></a>  y <span class="ot">&lt;-</span> dt[, <span class="dv">1</span>]</span>
<span id="cb733-15"><a href="forecast.html#cb733-15" tabindex="-1"></a>  X <span class="ot">&lt;-</span> dt[, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb733-16"><a href="forecast.html#cb733-16" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>h) {</span>
<span id="cb733-17"><a href="forecast.html#cb733-17" tabindex="-1"></a>    fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> X)</span>
<span id="cb733-18"><a href="forecast.html#cb733-18" tabindex="-1"></a>    fh[s, i] <span class="ot">&lt;-</span> <span class="fu">last</span>(fit<span class="sc">$</span>fitted.values)</span>
<span id="cb733-19"><a href="forecast.html#cb733-19" tabindex="-1"></a>    y <span class="ot">&lt;-</span> y[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb733-20"><a href="forecast.html#cb733-20" tabindex="-1"></a>    X <span class="ot">&lt;-</span> X[<span class="sc">-</span><span class="fu">nrow</span>(X), ]</span>
<span id="cb733-21"><a href="forecast.html#cb733-21" tabindex="-1"></a>  }</span>
<span id="cb733-22"><a href="forecast.html#cb733-22" tabindex="-1"></a>}</span>
<span id="cb733-23"><a href="forecast.html#cb733-23" tabindex="-1"></a></span>
<span id="cb733-24"><a href="forecast.html#cb733-24" tabindex="-1"></a>fh</span></code></pre></div>
<pre><code>##             1          2           3          4          5           6
## 3   -4.292862  -6.288479   5.2727764  10.692206  22.133103  -0.5252184
## 4   -5.014668  -1.626752   8.2861736  23.982849   4.611554  -0.2773355
## 5   -1.125996   1.634917  20.7212780   6.767507   5.115816  -0.5577792
## 6    1.533541  14.584416   5.6832803   8.066816   4.937718  -6.8419291
## 7   13.228621   1.612629   7.3973443   7.980486  -1.484987  -5.3696924
## 8    2.812780   3.308271   7.6799879   1.589578  -1.265470  -9.6077196
## 9   -5.430448   1.811491   0.7675925   1.698785  -7.123733 -16.9647249
## 10  -5.488847  -4.382922   0.8842250  -4.199708 -14.615359 -13.8839491
## 11 -11.104866  -4.133680  -5.3274242 -11.510596 -11.935885 -18.5728995
## 12 -11.656935  -8.289153 -11.9044832  -9.515252 -16.534428 -16.8239307
## 13 -18.314269 -13.292359  -9.2157517 -14.330746 -15.341226 -13.0680709
## 14 -23.661938 -10.963027 -13.9621680 -12.855445 -11.683527 -12.3975126
##            7
## 3  -19.79742
## 4  -19.62517
## 5  -26.29534
## 6  -23.77712
## 7  -20.07199
## 8  -27.04771
## 9  -25.44710
## 10 -30.22356
## 11 -29.91304
## 12 -25.62393
## 13 -25.15019
## 14 -27.72488</code></pre>
<p>Rows in <code>fh</code> show the 7-day forecast for each window size. We can see which window size is the best:</p>
<div class="sourceCode" id="cb735"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb735-1"><a href="forecast.html#cb735-1" tabindex="-1"></a>rmspe <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb735-2"><a href="forecast.html#cb735-2" tabindex="-1"></a></span>
<span id="cb735-3"><a href="forecast.html#cb735-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(fh)) {</span>
<span id="cb735-4"><a href="forecast.html#cb735-4" tabindex="-1"></a>  rmspe[i] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((fh[i, ] <span class="sc">-</span> test) <span class="sc">^</span> <span class="dv">2</span>))</span>
<span id="cb735-5"><a href="forecast.html#cb735-5" tabindex="-1"></a>}</span>
<span id="cb735-6"><a href="forecast.html#cb735-6" tabindex="-1"></a></span>
<span id="cb735-7"><a href="forecast.html#cb735-7" tabindex="-1"></a>rmspe</span></code></pre></div>
<pre><code>##  [1] 33.45400 35.28827 31.67333 29.69115 31.57618 28.99568 28.53882 28.70796
##  [9] 27.16182 28.59872 28.77714 28.99870</code></pre>
<div class="sourceCode" id="cb737"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb737-1"><a href="forecast.html#cb737-1" tabindex="-1"></a><span class="fu">which.min</span>(rmspe)</span></code></pre></div>
<pre><code>## [1] 9</code></pre>
<p>We used the last 7 days in our data as our test set. A natural question would be whether we could shuffle the data and use <strong>any</strong> 7 days as our test set? The answer is yes, because we do not need to follow a temporal order in the data after rearranging it with embedding. This is important because we can add a bootstrapping loop to our grid search above and get better tuning for finding the best window size.</p>
<p>We incorporate all these ideas with our random forest application in the next chapter.</p>
</div>
<div id="random-forest-1" class="section level2 hasAnchor" number="23.4">
<h2><span class="header-section-number">23.4</span> Random Forest<a href="forecast.html#random-forest-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We will utilize embedding methods for direct forecasting with Random Forests. We choose the random forests algorithm because it does not need an explicit tuning by a grid search. In the practice, however, we can still search for the number of trees and the number of variables randomly sampled as candidates at each split.</p>
<p>Let’s get our COVID-19 data:</p>
<div class="sourceCode" id="cb739"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb739-1"><a href="forecast.html#cb739-1" tabindex="-1"></a><span class="fu">library</span>(tsibble)</span>
<span id="cb739-2"><a href="forecast.html#cb739-2" tabindex="-1"></a><span class="fu">library</span>(fpp3)</span>
<span id="cb739-3"><a href="forecast.html#cb739-3" tabindex="-1"></a></span>
<span id="cb739-4"><a href="forecast.html#cb739-4" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;toronto2.rds&quot;</span>)</span>
<span id="cb739-5"><a href="forecast.html#cb739-5" tabindex="-1"></a>day <span class="ot">&lt;-</span> <span class="fu">seq.Date</span>(</span>
<span id="cb739-6"><a href="forecast.html#cb739-6" tabindex="-1"></a>  <span class="at">from =</span> <span class="fu">as.Date</span>(<span class="st">&quot;2020/03/01&quot;</span>),</span>
<span id="cb739-7"><a href="forecast.html#cb739-7" tabindex="-1"></a>  <span class="at">to =</span> <span class="fu">as.Date</span>(<span class="st">&quot;2020/11/21&quot;</span>),</span>
<span id="cb739-8"><a href="forecast.html#cb739-8" tabindex="-1"></a>  <span class="at">by =</span> <span class="dv">1</span></span>
<span id="cb739-9"><a href="forecast.html#cb739-9" tabindex="-1"></a>)</span>
<span id="cb739-10"><a href="forecast.html#cb739-10" tabindex="-1"></a></span>
<span id="cb739-11"><a href="forecast.html#cb739-11" tabindex="-1"></a>tdata <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Day =</span> day, data[, <span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb739-12"><a href="forecast.html#cb739-12" tabindex="-1"></a>toronto2 <span class="ot">&lt;-</span> tdata <span class="sc">%&gt;%</span></span>
<span id="cb739-13"><a href="forecast.html#cb739-13" tabindex="-1"></a>  <span class="fu">as_tsibble</span>(<span class="at">index =</span> Day)</span>
<span id="cb739-14"><a href="forecast.html#cb739-14" tabindex="-1"></a>toronto2</span></code></pre></div>
<pre><code>## # A tsibble: 266 x 8 [1D]
##    Day        cases      mob delay  male   age  temp   hum
##    &lt;date&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 2020-03-01     4 -0.0172  36.8  0.75   55   -4.2   65.5
##  2 2020-03-02     6 -0.0320   8.5  1      45    3.8   84  
##  3 2020-03-03    10 -0.0119  15    0.7    54    2.3   90  
##  4 2020-03-04     7  0.0186  25.7  0.286  50    3.35  71  
##  5 2020-03-05     7  0.0223  21    0.429  48.6  1.2   63.5
##  6 2020-03-06    10 -0.00626 13.1  0.5    36    0.04  75  
##  7 2020-03-07     8  0.0261  10.4  0.5    46.2 -1.65  54  
##  8 2020-03-08    10  0.0273  11.6  0.9    50    6.3   56  
##  9 2020-03-09    18 -0.0158   8.89 0.611  35.6 12.5   55  
## 10 2020-03-10    29 -0.0521   9.69 0.448  41.7  5.15  79  
## # ℹ 256 more rows</code></pre>
<p>As before, the data contain the first wave and the initial part of the second wave in Toronto for 2020. It is from <a href="https://data.ontario.ca/en/dataset?groups=2019-novel-coronavirus#byPHU">Ontario Data Catalogue</a> sorted by episode dates (<code>Day</code>), which is the date when the first symptoms were started. The mobility data is from Facebook, <code>all_day_bing_tiles_visited_relative_change</code>, which is reflects positive or negative change in movement relative to baseline. The other variables related to tests are <code>delay</code>, which is the time between test results and the episode date, the gender distribution of people is given by <code>male</code>, <code>age</code> shows the average age among tested people any given day. The last two variables, <code>temp</code> and <code>hum</code>, show the daily maximum day temperature and the average outdoor humidity during the day, respectively.</p>
<p>Except for <code>age</code> all other variables are non-stationary. We will take their first difference and make the series stationary before we proceed.</p>
<div class="sourceCode" id="cb741"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb741-1"><a href="forecast.html#cb741-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> toronto2 <span class="sc">%&gt;%</span></span>
<span id="cb741-2"><a href="forecast.html#cb741-2" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb741-3"><a href="forecast.html#cb741-3" tabindex="-1"></a>    <span class="at">dcases =</span> <span class="fu">difference</span>(cases),</span>
<span id="cb741-4"><a href="forecast.html#cb741-4" tabindex="-1"></a>    <span class="at">dmob =</span> <span class="fu">difference</span>(mob),</span>
<span id="cb741-5"><a href="forecast.html#cb741-5" tabindex="-1"></a>    <span class="at">ddelay =</span> <span class="fu">difference</span>(delay),</span>
<span id="cb741-6"><a href="forecast.html#cb741-6" tabindex="-1"></a>    <span class="at">dmale =</span> <span class="fu">difference</span>(male),</span>
<span id="cb741-7"><a href="forecast.html#cb741-7" tabindex="-1"></a>    <span class="at">dtemp =</span> <span class="fu">difference</span>(temp),</span>
<span id="cb741-8"><a href="forecast.html#cb741-8" tabindex="-1"></a>    <span class="at">dhum =</span> <span class="fu">difference</span>(hum)</span>
<span id="cb741-9"><a href="forecast.html#cb741-9" tabindex="-1"></a>  )</span>
<span id="cb741-10"><a href="forecast.html#cb741-10" tabindex="-1"></a></span>
<span id="cb741-11"><a href="forecast.html#cb741-11" tabindex="-1"></a>dft <span class="ot">&lt;-</span> df[, <span class="sc">-</span><span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">8</span>)] <span class="co">#removing levels</span></span>
<span id="cb741-12"><a href="forecast.html#cb741-12" tabindex="-1"></a>dft <span class="ot">&lt;-</span> dft[<span class="sc">-</span><span class="dv">1</span>, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">7</span>, <span class="dv">2</span>)] <span class="co"># reordering the columns</span></span></code></pre></div>
<p>First, we will use a univariate setting for a single-window forecasting, which is the last 7 days.</p>
</div>
<div id="univariate" class="section level2 hasAnchor" number="23.5">
<h2><span class="header-section-number">23.5</span> Univariate<a href="forecast.html#univariate" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We will not have a grid search on the random forest algorithm, which could be added to the following script:</p>
<div class="sourceCode" id="cb742"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb742-1"><a href="forecast.html#cb742-1" tabindex="-1"></a><span class="fu">library</span>(randomForest)</span>
<span id="cb742-2"><a href="forecast.html#cb742-2" tabindex="-1"></a></span>
<span id="cb742-3"><a href="forecast.html#cb742-3" tabindex="-1"></a>h <span class="ot">=</span> <span class="dv">7</span></span>
<span id="cb742-4"><a href="forecast.html#cb742-4" tabindex="-1"></a>w <span class="ot">&lt;-</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">21</span> <span class="co"># a grid for window size</span></span>
<span id="cb742-5"><a href="forecast.html#cb742-5" tabindex="-1"></a></span>
<span id="cb742-6"><a href="forecast.html#cb742-6" tabindex="-1"></a>fh <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="fu">length</span>(w), h)</span>
<span id="cb742-7"><a href="forecast.html#cb742-7" tabindex="-1"></a><span class="fu">rownames</span>(fh) <span class="ot">&lt;-</span> w</span>
<span id="cb742-8"><a href="forecast.html#cb742-8" tabindex="-1"></a><span class="fu">colnames</span>(fh) <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>h</span>
<span id="cb742-9"><a href="forecast.html#cb742-9" tabindex="-1"></a></span>
<span id="cb742-10"><a href="forecast.html#cb742-10" tabindex="-1"></a><span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(w)) {</span>
<span id="cb742-11"><a href="forecast.html#cb742-11" tabindex="-1"></a>  dt <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">embed</span>(<span class="fu">as.matrix</span>(dft[, <span class="dv">2</span>]), w[s]))</span>
<span id="cb742-12"><a href="forecast.html#cb742-12" tabindex="-1"></a>  test_ind <span class="ot">=</span> <span class="fu">nrow</span>(dt) <span class="sc">-</span> (h)</span>
<span id="cb742-13"><a href="forecast.html#cb742-13" tabindex="-1"></a>  train <span class="ot">&lt;-</span> dt[<span class="dv">1</span><span class="sc">:</span>test_ind,]</span>
<span id="cb742-14"><a href="forecast.html#cb742-14" tabindex="-1"></a>  test <span class="ot">&lt;-</span> dt[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>test_ind),]</span>
<span id="cb742-15"><a href="forecast.html#cb742-15" tabindex="-1"></a>  y <span class="ot">&lt;-</span> train[, <span class="dv">1</span>]</span>
<span id="cb742-16"><a href="forecast.html#cb742-16" tabindex="-1"></a>  X <span class="ot">&lt;-</span> train[, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb742-17"><a href="forecast.html#cb742-17" tabindex="-1"></a>  </span>
<span id="cb742-18"><a href="forecast.html#cb742-18" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>h) {</span>
<span id="cb742-19"><a href="forecast.html#cb742-19" tabindex="-1"></a>    fit <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(X, y)</span>
<span id="cb742-20"><a href="forecast.html#cb742-20" tabindex="-1"></a>    fh[s,] <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit, test[, <span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb742-21"><a href="forecast.html#cb742-21" tabindex="-1"></a>    y <span class="ot">&lt;-</span> y[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb742-22"><a href="forecast.html#cb742-22" tabindex="-1"></a>    X <span class="ot">&lt;-</span> X[<span class="sc">-</span><span class="fu">nrow</span>(X),]</span>
<span id="cb742-23"><a href="forecast.html#cb742-23" tabindex="-1"></a>  }</span>
<span id="cb742-24"><a href="forecast.html#cb742-24" tabindex="-1"></a>}</span>
<span id="cb742-25"><a href="forecast.html#cb742-25" tabindex="-1"></a></span>
<span id="cb742-26"><a href="forecast.html#cb742-26" tabindex="-1"></a>fh</span></code></pre></div>
<pre><code>##                1          2        3          4         5           6         7
## 3  -15.880433333   9.121167 19.74952  -6.609067 -5.722785  15.3516667 -2.087685
## 4   -9.544133333  -6.810200 23.81880  -4.161529 -1.214533   0.5277333  5.875767
## 5   -2.893600000  -6.885967 32.69350  -8.538333 -2.237667  -5.7720778 11.219167
## 6    0.070366667  -8.057467 22.55983 -12.094967 14.929700 -11.2058667 17.507433
## 7   -2.908866667 -15.868133 30.45953 -13.805133 19.191067 -23.7922000 14.290767
## 8    7.417066667 -22.705167 39.25673  -9.230933 13.765733 -15.4590667 27.734367
## 9   -3.620766667 -33.568367 68.65190 -20.472133 12.023133 -25.9268333 19.220533
## 10  -5.063400000 -33.309933 68.74610 -23.970333 14.040067 -25.0332000 12.531533
## 11  -0.009233333 -31.799500 60.88173 -23.562800 19.142833 -19.2536000 13.502400
## 12   0.805100000 -28.058533 55.59913 -26.090367 13.274300 -14.7545000 10.550400
## 13  -2.226166667 -30.789467 59.84473 -25.233567 15.489200 -11.8885333 15.370867
## 14  -1.639966667 -29.185000 58.61637 -21.431733 14.705067  -9.6757333 13.182233
## 15  -5.260733333 -33.169933 48.44817 -21.982467 14.593733 -12.0262667  9.309300
## 16  -5.429300000 -37.097867 61.44953 -21.993267 11.335233 -11.8728667 10.263967
## 17 -10.734700000 -33.021967 67.64857 -25.555300 16.965033 -10.5087667 10.809200
## 18  -6.696733333 -32.629567 59.85407 -23.227433 13.093067 -10.5785667 11.307200
## 19 -11.170300000 -36.225467 54.98873 -25.408567 16.683433 -14.8820000 12.992233
## 20  -3.524700000 -33.719100 61.33873 -23.823233 13.677867 -12.6076333 16.435500
## 21  -5.546933333 -31.462433 53.45857 -22.071567  9.086700 -13.1858667 15.337400</code></pre>
<p>We can now see RMSPE for each row (window size):</p>
<div class="sourceCode" id="cb744"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb744-1"><a href="forecast.html#cb744-1" tabindex="-1"></a>actual <span class="ot">&lt;-</span> test[, <span class="dv">1</span>]</span>
<span id="cb744-2"><a href="forecast.html#cb744-2" tabindex="-1"></a>rmspe <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb744-3"><a href="forecast.html#cb744-3" tabindex="-1"></a></span>
<span id="cb744-4"><a href="forecast.html#cb744-4" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(fh)) {</span>
<span id="cb744-5"><a href="forecast.html#cb744-5" tabindex="-1"></a>  rmspe[i] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((fh[i,] <span class="sc">-</span> actual) <span class="sc">^</span> <span class="dv">2</span>))</span>
<span id="cb744-6"><a href="forecast.html#cb744-6" tabindex="-1"></a>}</span>
<span id="cb744-7"><a href="forecast.html#cb744-7" tabindex="-1"></a></span>
<span id="cb744-8"><a href="forecast.html#cb744-8" tabindex="-1"></a>rmspe</span></code></pre></div>
<pre><code>##  [1] 42.27364 44.57501 44.73248 44.35358 44.75067 51.39679 53.18043 51.53383
##  [9] 50.71377 48.11244 50.52535 50.43200 48.67944 51.68634 51.56775 50.45623
## [17] 50.10037 51.65413 49.68998</code></pre>
<div class="sourceCode" id="cb746"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb746-1"><a href="forecast.html#cb746-1" tabindex="-1"></a><span class="fu">which.min</span>(rmspe)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<p>And, if we plot several series of our forecast with different window sizes:</p>
<div class="sourceCode" id="cb748"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb748-1"><a href="forecast.html#cb748-1" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb748-2"><a href="forecast.html#cb748-2" tabindex="-1"></a>  actual,</span>
<span id="cb748-3"><a href="forecast.html#cb748-3" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb748-4"><a href="forecast.html#cb748-4" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb748-5"><a href="forecast.html#cb748-5" tabindex="-1"></a>  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">80</span>, <span class="dv">50</span>),</span>
<span id="cb748-6"><a href="forecast.html#cb748-6" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">&quot;Actual (red) vs. Forecasts&quot;</span>,</span>
<span id="cb748-7"><a href="forecast.html#cb748-7" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;Last 7 days&quot;</span>,</span>
<span id="cb748-8"><a href="forecast.html#cb748-8" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;7-Day Foerecasts&quot;</span>,</span>
<span id="cb748-9"><a href="forecast.html#cb748-9" tabindex="-1"></a>  <span class="at">lwd =</span> <span class="dv">3</span></span>
<span id="cb748-10"><a href="forecast.html#cb748-10" tabindex="-1"></a>)</span>
<span id="cb748-11"><a href="forecast.html#cb748-11" tabindex="-1"></a><span class="fu">lines</span>(fh[<span class="dv">1</span>,], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb748-12"><a href="forecast.html#cb748-12" tabindex="-1"></a><span class="fu">lines</span>(fh[<span class="dv">2</span>,], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&quot;green&quot;</span>)</span>
<span id="cb748-13"><a href="forecast.html#cb748-13" tabindex="-1"></a><span class="fu">lines</span>(fh[<span class="dv">5</span>,], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&quot;orange&quot;</span>)</span>
<span id="cb748-14"><a href="forecast.html#cb748-14" tabindex="-1"></a><span class="fu">lines</span>(fh[<span class="dv">12</span>,], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb748-15"><a href="forecast.html#cb748-15" tabindex="-1"></a><span class="fu">legend</span>(</span>
<span id="cb748-16"><a href="forecast.html#cb748-16" tabindex="-1"></a>  <span class="st">&quot;bottomright&quot;</span>,</span>
<span id="cb748-17"><a href="forecast.html#cb748-17" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">&quot;Lags&quot;</span>,</span>
<span id="cb748-18"><a href="forecast.html#cb748-18" tabindex="-1"></a>  <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;3-day&quot;</span>, <span class="st">&quot;4-day&quot;</span>, <span class="st">&quot;7-day&quot;</span>, <span class="st">&quot;14-day&quot;</span>),</span>
<span id="cb748-19"><a href="forecast.html#cb748-19" tabindex="-1"></a>  <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;orange&quot;</span>),</span>
<span id="cb748-20"><a href="forecast.html#cb748-20" tabindex="-1"></a>  <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb748-21"><a href="forecast.html#cb748-21" tabindex="-1"></a>  <span class="at">bty =</span> <span class="st">&quot;o&quot;</span>,</span>
<span id="cb748-22"><a href="forecast.html#cb748-22" tabindex="-1"></a>  <span class="at">cex =</span> <span class="fl">0.75</span></span>
<span id="cb748-23"><a href="forecast.html#cb748-23" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="23-Forecast_files/figure-html/tsr5-1.png" width="672" /></p>
<p>As the window size gets larger, the forecast becomes increasingly smooth missing the short term dynamics. Another observation is that, although “blue” (3-day window) has the minimum RMSPE, it is not able to capture ups and downs relative to 7-day or 14-day windows.</p>
</div>
<div id="multivariate" class="section level2 hasAnchor" number="23.6">
<h2><span class="header-section-number">23.6</span> Multivariate<a href="forecast.html#multivariate" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Can we increase the prediction accuracy with additional predictors?</p>
<div class="sourceCode" id="cb749"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb749-1"><a href="forecast.html#cb749-1" tabindex="-1"></a><span class="fu">library</span>(randomForest)</span>
<span id="cb749-2"><a href="forecast.html#cb749-2" tabindex="-1"></a></span>
<span id="cb749-3"><a href="forecast.html#cb749-3" tabindex="-1"></a>h <span class="ot">=</span> <span class="dv">7</span></span>
<span id="cb749-4"><a href="forecast.html#cb749-4" tabindex="-1"></a>w <span class="ot">&lt;-</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">14</span> <span class="co"># a grid for window size</span></span>
<span id="cb749-5"><a href="forecast.html#cb749-5" tabindex="-1"></a></span>
<span id="cb749-6"><a href="forecast.html#cb749-6" tabindex="-1"></a>fh <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="fu">length</span>(w), h)</span>
<span id="cb749-7"><a href="forecast.html#cb749-7" tabindex="-1"></a><span class="fu">rownames</span>(fh) <span class="ot">&lt;-</span> w</span>
<span id="cb749-8"><a href="forecast.html#cb749-8" tabindex="-1"></a><span class="fu">colnames</span>(fh) <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>h</span>
<span id="cb749-9"><a href="forecast.html#cb749-9" tabindex="-1"></a></span>
<span id="cb749-10"><a href="forecast.html#cb749-10" tabindex="-1"></a><span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(w)) {</span>
<span id="cb749-11"><a href="forecast.html#cb749-11" tabindex="-1"></a>  dt <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">embed</span>(<span class="fu">as.matrix</span>(dft[, <span class="sc">-</span><span class="dv">1</span>]), w[s]))</span>
<span id="cb749-12"><a href="forecast.html#cb749-12" tabindex="-1"></a>  test_ind <span class="ot">=</span> <span class="fu">nrow</span>(dt) <span class="sc">-</span> (h)</span>
<span id="cb749-13"><a href="forecast.html#cb749-13" tabindex="-1"></a>  train <span class="ot">&lt;-</span> dt[<span class="dv">1</span><span class="sc">:</span>test_ind,]</span>
<span id="cb749-14"><a href="forecast.html#cb749-14" tabindex="-1"></a>  test <span class="ot">&lt;-</span> dt[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>test_ind),]</span>
<span id="cb749-15"><a href="forecast.html#cb749-15" tabindex="-1"></a>  y <span class="ot">&lt;-</span> train[, <span class="dv">1</span>]</span>
<span id="cb749-16"><a href="forecast.html#cb749-16" tabindex="-1"></a>  X <span class="ot">&lt;-</span> train[, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb749-17"><a href="forecast.html#cb749-17" tabindex="-1"></a>  </span>
<span id="cb749-18"><a href="forecast.html#cb749-18" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>h) {</span>
<span id="cb749-19"><a href="forecast.html#cb749-19" tabindex="-1"></a>    fit <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(X, y)</span>
<span id="cb749-20"><a href="forecast.html#cb749-20" tabindex="-1"></a>    fh[s,] <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit, test[, <span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb749-21"><a href="forecast.html#cb749-21" tabindex="-1"></a>    y <span class="ot">&lt;-</span> y[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb749-22"><a href="forecast.html#cb749-22" tabindex="-1"></a>    X <span class="ot">&lt;-</span> X[<span class="sc">-</span><span class="fu">nrow</span>(X),]</span>
<span id="cb749-23"><a href="forecast.html#cb749-23" tabindex="-1"></a>  }</span>
<span id="cb749-24"><a href="forecast.html#cb749-24" tabindex="-1"></a>}</span>
<span id="cb749-25"><a href="forecast.html#cb749-25" tabindex="-1"></a></span>
<span id="cb749-26"><a href="forecast.html#cb749-26" tabindex="-1"></a>fh</span></code></pre></div>
<pre><code>##             1           2        3          4          5          6         7
## 3  -17.788533  -0.3141000 16.53653  -9.326433 -18.102767  10.969800 -3.163967
## 4  -22.697100  -3.4509000 15.49413  -8.524767 -12.633133   2.173933 -3.292467
## 5  -13.800000  -0.7464333 16.56037 -11.723300  -7.062600 -13.184300  2.813033
## 6  -11.665500   1.9710333 20.05657 -10.684600   3.292100  -9.363967  6.406867
## 7   -9.373733  -5.8512667 23.13793 -17.310433   6.720633 -16.444167 11.981633
## 8  -10.233033 -12.3322000 22.61410  -9.796867   5.102200 -14.007967 12.177500
## 9  -12.145600 -22.5280667 45.52763 -22.078400   7.680600 -21.096567  8.656400
## 10 -11.179767 -19.4309000 47.87777 -23.726333   8.190267 -22.027567 12.756467
## 11  -8.145300 -18.9786333 49.77097 -26.724600  14.152900 -21.407233 11.465667
## 12 -10.947600 -18.4935667 47.21440 -23.789367   9.581900 -19.870133  8.059733
## 13  -9.108533 -16.9865000 40.43617 -22.952300   9.804567 -19.631100 10.097000
## 14 -10.174000 -20.3914333 43.31103 -26.960767  12.482533 -19.625367  5.761600</code></pre>
<div class="sourceCode" id="cb751"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb751-1"><a href="forecast.html#cb751-1" tabindex="-1"></a>actual <span class="ot">&lt;-</span> test[, <span class="dv">1</span>]</span>
<span id="cb751-2"><a href="forecast.html#cb751-2" tabindex="-1"></a>rmspe <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb751-3"><a href="forecast.html#cb751-3" tabindex="-1"></a></span>
<span id="cb751-4"><a href="forecast.html#cb751-4" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(fh)) {</span>
<span id="cb751-5"><a href="forecast.html#cb751-5" tabindex="-1"></a>  rmspe[i] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((fh[i, ] <span class="sc">-</span> actual) <span class="sc">^</span> <span class="dv">2</span>))</span>
<span id="cb751-6"><a href="forecast.html#cb751-6" tabindex="-1"></a>}</span>
<span id="cb751-7"><a href="forecast.html#cb751-7" tabindex="-1"></a></span>
<span id="cb751-8"><a href="forecast.html#cb751-8" tabindex="-1"></a>rmspe</span></code></pre></div>
<pre><code>##  [1] 42.25558 41.30589 38.97195 40.04286 40.51307 43.67209 44.61230 44.66197
##  [9] 44.42342 43.71028 42.97556 42.68597</code></pre>
<div class="sourceCode" id="cb753"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb753-1"><a href="forecast.html#cb753-1" tabindex="-1"></a><span class="fu">which.min</span>(rmspe)</span></code></pre></div>
<pre><code>## [1] 3</code></pre>
<div class="sourceCode" id="cb755"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb755-1"><a href="forecast.html#cb755-1" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb755-2"><a href="forecast.html#cb755-2" tabindex="-1"></a>  actual,</span>
<span id="cb755-3"><a href="forecast.html#cb755-3" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb755-4"><a href="forecast.html#cb755-4" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb755-5"><a href="forecast.html#cb755-5" tabindex="-1"></a>  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">80</span>,<span class="sc">+</span><span class="dv">50</span>),</span>
<span id="cb755-6"><a href="forecast.html#cb755-6" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">&quot;Actual (red) vs. Forecasts&quot;</span>,</span>
<span id="cb755-7"><a href="forecast.html#cb755-7" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;Last 7 days&quot;</span>,</span>
<span id="cb755-8"><a href="forecast.html#cb755-8" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;7-Day Foerecasts&quot;</span>,</span>
<span id="cb755-9"><a href="forecast.html#cb755-9" tabindex="-1"></a>  <span class="at">lwd =</span> <span class="dv">3</span></span>
<span id="cb755-10"><a href="forecast.html#cb755-10" tabindex="-1"></a>)</span>
<span id="cb755-11"><a href="forecast.html#cb755-11" tabindex="-1"></a><span class="fu">lines</span>(fh[<span class="dv">1</span>,], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb755-12"><a href="forecast.html#cb755-12" tabindex="-1"></a><span class="fu">lines</span>(fh[<span class="dv">3</span>,], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&quot;green&quot;</span>)</span>
<span id="cb755-13"><a href="forecast.html#cb755-13" tabindex="-1"></a><span class="fu">lines</span>(fh[<span class="dv">5</span>,], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&quot;orange&quot;</span>)</span>
<span id="cb755-14"><a href="forecast.html#cb755-14" tabindex="-1"></a><span class="fu">lines</span>(fh[<span class="dv">12</span>,], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb755-15"><a href="forecast.html#cb755-15" tabindex="-1"></a><span class="fu">legend</span>(</span>
<span id="cb755-16"><a href="forecast.html#cb755-16" tabindex="-1"></a>  <span class="st">&quot;bottomright&quot;</span>,</span>
<span id="cb755-17"><a href="forecast.html#cb755-17" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">&quot;Lags&quot;</span>,</span>
<span id="cb755-18"><a href="forecast.html#cb755-18" tabindex="-1"></a>  <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;3-day&quot;</span>, <span class="st">&quot;5-day&quot;</span>, <span class="st">&quot;7-day&quot;</span>, <span class="st">&quot;14-day&quot;</span>),</span>
<span id="cb755-19"><a href="forecast.html#cb755-19" tabindex="-1"></a>  <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;black&quot;</span>),</span>
<span id="cb755-20"><a href="forecast.html#cb755-20" tabindex="-1"></a>  <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb755-21"><a href="forecast.html#cb755-21" tabindex="-1"></a>  <span class="at">bty =</span> <span class="st">&quot;o&quot;</span>,</span>
<span id="cb755-22"><a href="forecast.html#cb755-22" tabindex="-1"></a>  <span class="at">cex =</span> <span class="fl">0.75</span></span>
<span id="cb755-23"><a href="forecast.html#cb755-23" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="23-Forecast_files/figure-html/tsr7-1.png" width="672" /></p>
<p>It seems that additional predictors do increase the accuracy. Again, relative to the best model (5-day window) our 7-day window correctly captures most ups and downs in the forecast. Now, a visual inspection shows that all RMSPE’s are lower than the univariate forecasts. We would conclude that this is because of the new predictors, specially mobility, temperature, and humidity. As a side note, we need to test if those differences are statistical significant or not (i.e. Diebold-Mariano Test).</p>
</div>
<div id="rolling-and-expanding-windows" class="section level2 hasAnchor" number="23.7">
<h2><span class="header-section-number">23.7</span> Rolling and expanding windows<a href="forecast.html#rolling-and-expanding-windows" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A seven-day window is not enough for a reliable judgment on the forecast accuracy. One way to deal with this issue is to use rolling or expanding windows to predict the next h days. The following example shows a 1-day-ahead forecast with varying lags for embedding.</p>
<div class="sourceCode" id="cb756"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb756-1"><a href="forecast.html#cb756-1" tabindex="-1"></a><span class="fu">library</span>(randomForest)</span>
<span id="cb756-2"><a href="forecast.html#cb756-2" tabindex="-1"></a></span>
<span id="cb756-3"><a href="forecast.html#cb756-3" tabindex="-1"></a>l <span class="ot">=</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">10</span> <span class="co"># lags for embedding</span></span>
<span id="cb756-4"><a href="forecast.html#cb756-4" tabindex="-1"></a>ws <span class="ot">=</span> <span class="dv">150</span> <span class="co"># size of each rolling window</span></span>
<span id="cb756-5"><a href="forecast.html#cb756-5" tabindex="-1"></a>rmspe <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb756-6"><a href="forecast.html#cb756-6" tabindex="-1"></a></span>
<span id="cb756-7"><a href="forecast.html#cb756-7" tabindex="-1"></a>all_fh <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">&quot;list&quot;</span>, <span class="at">length =</span> <span class="fu">length</span>(l))</span>
<span id="cb756-8"><a href="forecast.html#cb756-8" tabindex="-1"></a>all_y <span class="ot">&lt;-</span>  <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">&quot;list&quot;</span>, <span class="at">length =</span> <span class="fu">length</span>(l))</span>
<span id="cb756-9"><a href="forecast.html#cb756-9" tabindex="-1"></a></span>
<span id="cb756-10"><a href="forecast.html#cb756-10" tabindex="-1"></a><span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(l)) {</span>
<span id="cb756-11"><a href="forecast.html#cb756-11" tabindex="-1"></a>  dt <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">embed</span>(<span class="fu">as.matrix</span>(dft[,<span class="sc">-</span><span class="dv">1</span>]), l[s]))</span>
<span id="cb756-12"><a href="forecast.html#cb756-12" tabindex="-1"></a>  nwin <span class="ot">&lt;-</span> <span class="fu">nrow</span>(dt) <span class="sc">-</span> ws <span class="co">#number of windows</span></span>
<span id="cb756-13"><a href="forecast.html#cb756-13" tabindex="-1"></a>  fh <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb756-14"><a href="forecast.html#cb756-14" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb756-15"><a href="forecast.html#cb756-15" tabindex="-1"></a>  </span>
<span id="cb756-16"><a href="forecast.html#cb756-16" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nwin) {</span>
<span id="cb756-17"><a href="forecast.html#cb756-17" tabindex="-1"></a>    train <span class="ot">&lt;-</span> dt[i<span class="sc">:</span>(ws <span class="sc">+</span> i <span class="sc">-</span> <span class="dv">1</span>),] <span class="co"># each loop, window moves one day forward</span></span>
<span id="cb756-18"><a href="forecast.html#cb756-18" tabindex="-1"></a>    test <span class="ot">&lt;-</span> dt[(ws <span class="sc">+</span> i),]</span>
<span id="cb756-19"><a href="forecast.html#cb756-19" tabindex="-1"></a>    </span>
<span id="cb756-20"><a href="forecast.html#cb756-20" tabindex="-1"></a>    <span class="fu">set.seed</span>(i <span class="sc">+</span> s)</span>
<span id="cb756-21"><a href="forecast.html#cb756-21" tabindex="-1"></a>    fit <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(train[,<span class="sc">-</span><span class="dv">1</span>], train[, <span class="dv">1</span>])</span>
<span id="cb756-22"><a href="forecast.html#cb756-22" tabindex="-1"></a>    fh[i] <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit, test[,<span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb756-23"><a href="forecast.html#cb756-23" tabindex="-1"></a>    y[i] <span class="ot">&lt;-</span> test[, <span class="dv">1</span>] <span class="co"># to use later for plotting</span></span>
<span id="cb756-24"><a href="forecast.html#cb756-24" tabindex="-1"></a>  }</span>
<span id="cb756-25"><a href="forecast.html#cb756-25" tabindex="-1"></a>  all_y[[s]] <span class="ot">&lt;-</span> y</span>
<span id="cb756-26"><a href="forecast.html#cb756-26" tabindex="-1"></a>  all_fh[[s]] <span class="ot">&lt;-</span> fh</span>
<span id="cb756-27"><a href="forecast.html#cb756-27" tabindex="-1"></a>  err <span class="ot">&lt;-</span> test[, <span class="dv">1</span>] <span class="sc">-</span> fh</span>
<span id="cb756-28"><a href="forecast.html#cb756-28" tabindex="-1"></a>  rmspe[s] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(err <span class="sc">^</span> <span class="dv">2</span>))</span>
<span id="cb756-29"><a href="forecast.html#cb756-29" tabindex="-1"></a>}</span>
<span id="cb756-30"><a href="forecast.html#cb756-30" tabindex="-1"></a></span>
<span id="cb756-31"><a href="forecast.html#cb756-31" tabindex="-1"></a>rmspe</span></code></pre></div>
<pre><code>## [1] 45.00315 45.02472 45.31378 44.83595 45.81351 47.01531 47.14842 46.94298</code></pre>
<div class="sourceCode" id="cb758"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb758-1"><a href="forecast.html#cb758-1" tabindex="-1"></a>bst <span class="ot">&lt;-</span> <span class="fu">which.min</span>(rmspe)</span>
<span id="cb758-2"><a href="forecast.html#cb758-2" tabindex="-1"></a>l[bst] <span class="co"># Winning lag in embedding</span></span></code></pre></div>
<pre><code>## [1] 6</code></pre>
<p>To adjust the application above to an expanding-window forecast, we just need to change <code>dt[i:(ws + i - 1), ]</code> to <code>dt[1:(ws + i - 1), ]</code> in the script.</p>
<p>Now, we can plot the results:</p>
<div class="sourceCode" id="cb760"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb760-1"><a href="forecast.html#cb760-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb760-2"><a href="forecast.html#cb760-2" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb760-3"><a href="forecast.html#cb760-3" tabindex="-1"></a>  all_y[[bst]],</span>
<span id="cb760-4"><a href="forecast.html#cb760-4" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb760-5"><a href="forecast.html#cb760-5" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb760-6"><a href="forecast.html#cb760-6" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">&quot;Actual (red) vs Predicted (Blue)&quot;</span>,</span>
<span id="cb760-7"><a href="forecast.html#cb760-7" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;Days&quot;</span>,</span>
<span id="cb760-8"><a href="forecast.html#cb760-8" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;1-Day-Ahead&quot;</span></span>
<span id="cb760-9"><a href="forecast.html#cb760-9" tabindex="-1"></a>)</span>
<span id="cb760-10"><a href="forecast.html#cb760-10" tabindex="-1"></a><span class="fu">lines</span>(all_fh[[bst]], <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb760-11"><a href="forecast.html#cb760-11" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb760-12"><a href="forecast.html#cb760-12" tabindex="-1"></a>  all_y[[bst]][<span class="dv">60</span><span class="sc">:</span><span class="dv">110</span>],</span>
<span id="cb760-13"><a href="forecast.html#cb760-13" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;o&quot;</span>,</span>
<span id="cb760-14"><a href="forecast.html#cb760-14" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb760-15"><a href="forecast.html#cb760-15" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">&quot;Actual (red) vs Predicted (Blue)&quot;</span>,</span>
<span id="cb760-16"><a href="forecast.html#cb760-16" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;Days&quot;</span>,</span>
<span id="cb760-17"><a href="forecast.html#cb760-17" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;Last 50 Days&quot;</span></span>
<span id="cb760-18"><a href="forecast.html#cb760-18" tabindex="-1"></a>)</span>
<span id="cb760-19"><a href="forecast.html#cb760-19" tabindex="-1"></a><span class="fu">lines</span>(all_fh[[bst]][<span class="dv">60</span><span class="sc">:</span><span class="dv">110</span>], <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="23-Forecast_files/figure-html/tsr9-1.png" width="672" /></p>
<p>Getting the predicted values back to originals can be achieved by:</p>
<p><span class="math display">\[
\begin{aligned}
&amp; y_{t+1}=y_t+z_{t+1} \\
&amp; y_{t+2}=y_{t+1}+z_{t+2}=y_t+z_{t+1}+z_{t+2}
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb761"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb761-1"><a href="forecast.html#cb761-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">321</span>)</span>
<span id="cb761-2"><a href="forecast.html#cb761-2" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10</span>)</span>
<span id="cb761-3"><a href="forecast.html#cb761-3" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">diff</span>(y)     <span class="co"># first differences</span></span>
<span id="cb761-4"><a href="forecast.html#cb761-4" tabindex="-1"></a>back <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(<span class="fu">c</span>(y[<span class="dv">1</span>], z))</span>
<span id="cb761-5"><a href="forecast.html#cb761-5" tabindex="-1"></a><span class="fu">cbind</span>(y, back)</span></code></pre></div>
<pre><code>##                y       back
##  [1,]  1.7049032  1.7049032
##  [2,] -0.7120386 -0.7120386
##  [3,] -0.2779849 -0.2779849
##  [4,] -0.1196490 -0.1196490
##  [5,] -0.1239606 -0.1239606
##  [6,]  0.2681838  0.2681838
##  [7,]  0.7268415  0.7268415
##  [8,]  0.2331354  0.2331354
##  [9,]  0.3391139  0.3391139
## [10,] -0.5519147 -0.5519147</code></pre>
<p>Since our algorithm predict the changes in observations, a simple sum would do the job for back transformation. For example, as a starting point, our algorithm predicts the change in <span class="math inline">\(Y\)</span> from day 156 to 157 (window size 150 plus the best lag window, 6). When we add this predicted change to the actual <span class="math inline">\(Y\)</span> at 156, it will give us the back-transformed forecast at day 157.</p>
<div class="sourceCode" id="cb763"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb763-1"><a href="forecast.html#cb763-1" tabindex="-1"></a>y <span class="ot">&lt;-</span> df<span class="sc">$</span>cases</span>
<span id="cb763-2"><a href="forecast.html#cb763-2" tabindex="-1"></a></span>
<span id="cb763-3"><a href="forecast.html#cb763-3" tabindex="-1"></a><span class="co"># The first forecast is at ws (150) + l[best] (6) + 1, which is 157</span></span>
<span id="cb763-4"><a href="forecast.html#cb763-4" tabindex="-1"></a><span class="co"># The first actual Y should start a day earlier</span></span>
<span id="cb763-5"><a href="forecast.html#cb763-5" tabindex="-1"></a><span class="co"># removing all Y&#39;s until ws+l[bst]</span></span>
<span id="cb763-6"><a href="forecast.html#cb763-6" tabindex="-1"></a></span>
<span id="cb763-7"><a href="forecast.html#cb763-7" tabindex="-1"></a>y_a_day_before <span class="ot">&lt;-</span> y[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>(ws <span class="sc">+</span> l[bst] <span class="sc">-</span> <span class="dv">1</span>))]</span>
<span id="cb763-8"><a href="forecast.html#cb763-8" tabindex="-1"></a></span>
<span id="cb763-9"><a href="forecast.html#cb763-9" tabindex="-1"></a><span class="co"># This adds predicted changes to observed values a day earlier</span></span>
<span id="cb763-10"><a href="forecast.html#cb763-10" tabindex="-1"></a>back_forecast <span class="ot">&lt;-</span> <span class="fu">head</span>(y_a_day_before,<span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span> all_fh[[bst]]</span>
<span id="cb763-11"><a href="forecast.html#cb763-11" tabindex="-1"></a></span>
<span id="cb763-12"><a href="forecast.html#cb763-12" tabindex="-1"></a><span class="co"># Actual Y&#39;s in the test set starting at ws (150) + l[best] (6) + 1, which is 157</span></span>
<span id="cb763-13"><a href="forecast.html#cb763-13" tabindex="-1"></a>ytest <span class="ot">&lt;-</span> y[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>(ws <span class="sc">+</span> l[bst]))]</span>
<span id="cb763-14"><a href="forecast.html#cb763-14" tabindex="-1"></a></span>
<span id="cb763-15"><a href="forecast.html#cb763-15" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb763-16"><a href="forecast.html#cb763-16" tabindex="-1"></a>  ytest,</span>
<span id="cb763-17"><a href="forecast.html#cb763-17" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb763-18"><a href="forecast.html#cb763-18" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb763-19"><a href="forecast.html#cb763-19" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">&quot;Actual Y (Blue) vs Forecast (Red)&quot;</span>,</span>
<span id="cb763-20"><a href="forecast.html#cb763-20" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;Days&quot;</span>,</span>
<span id="cb763-21"><a href="forecast.html#cb763-21" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;Back-transformed Forecast&quot;</span></span>
<span id="cb763-22"><a href="forecast.html#cb763-22" tabindex="-1"></a>)</span>
<span id="cb763-23"><a href="forecast.html#cb763-23" tabindex="-1"></a><span class="fu">lines</span>(back_forecast, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="23-Forecast_files/figure-html/tsr11-1.png" width="672" /></p>
<p>It seems that, for most days, our algorithm simply forecasts the next day by using the value from the day before. If we change our algorithm to a 7-day-ahead forecast, this would be different. This is also a common problem when the predictive model has a poor forecasting power. Again, this is not due to our algorithm, but forecasting an epi curve with imperfect test data is almost impossible job, as we highlighted earlier.</p>
<p>In practice, however, there are several ways that we can improve the scripts above. For example, we can consider the (rolling or expanding) window size as a hyperparameter. We can also have an explicit training for the Random Forest algorithm. We can have an ensemble forecasting by adding other predictive algorithms to the script, like boosting. Further, we can develop a base forecast that would give us a benchmark to see how much our algorithm improves against that base. Lastly, we could apply a transformation to the data in order to stabilize the variance in all variables.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="time-series.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="support-vector-machine.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/mutluyuk/machinemetrics/edit/master/23-Forecast.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["machinemetrics.pdf", "machinemetrics.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
